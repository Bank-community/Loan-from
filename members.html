<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Community Loan</title>
    <style>
     body { font-family: Arial, sans-serif; margin: 0; background-color: #f9f9f9; }
        
        h3 { text-align: center; margin: 5px 0; font-size: 18px; color: #555; }
        .header { text-align: center; background-color: #007BFF; color: white; padding: 20px 0; display: flex; align-items: center; justify-content: center; }
        .header img { width: 50px; height: 50px; margin-right: 10px; }

.slider {
    width: 100%; /* ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§ï‡•Ä ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§´‡§ø‡§ï‡•ç‡§∏ ‡§ï‡§∞‡•á‡§Ç */
    height: auto;
    overflow: hidden;
    position: relative;
    margin: 10px 0;
    aspect-ratio: 10 / 3; /* ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§™‡§æ‡§§ 10:3 */
}

.slides {
    display: flex;
    width: 300%; /* ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§ï‡•Ä ‡§ï‡•Å‡§≤ ‡§ö‡•å‡§°‡§º‡§æ‡§à */
    animation: slide 15s infinite; /* ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§® */
}

.slides img {
    width: 34%; /* ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§ï‡•Ä ‡§ö‡•å‡§°‡§º‡§æ‡§à 34% */
    flex-shrink: 0; /* ‡§á‡§Æ‡•á‡§ú ‡§ï‡•ã ‡§∏‡§ø‡§ï‡•Å‡§°‡§º‡§®‡•á ‡§∏‡•á ‡§∞‡•ã‡§ï‡•á‡§Ç */
    height: auto; /* ‡§ä‡§Å‡§ö‡§æ‡§à ‡§ë‡§ü‡•ã‡§Æ‡•á‡§ü‡§ø‡§ï */
    object-fit: cover; /* ‡§á‡§Æ‡•á‡§ú ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§´‡§ø‡§ü ‡§π‡•ã */
}
.header, .slider {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 1000; /* ‡§ä‡§™‡§∞ ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è */
}

.slider {
    top: -10px; /* ‡§π‡•á‡§°‡§≤‡§æ‡§á‡§® ‡§ï‡•á ‡§®‡•Ä‡§ö‡•á ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è */
}

body {
    padding-top: 200px; /* ‡§π‡•á‡§°‡§∞ ‡§î‡§∞ ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§ï‡•á ‡§®‡•Ä‡§ö‡•á ‡§ï‡§Ç‡§ü‡•á‡§Ç‡§ü ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è */
}

@keyframes slide {
    0%, 33.33% { transform: translateX(0); } /* ‡§™‡§π‡§≤‡•á ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§™‡§∞ 6 ‡§∏‡•á‡§ï‡§Ç‡§° */
    33.34%, 66.66% { transform: translateX(-34%); } /* ‡§¶‡•Ç‡§∏‡§∞‡•á ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§™‡§∞ 6 ‡§∏‡•á‡§ï‡§Ç‡§° */
    66.67%, 100% { transform: translateX(-68%); } /* ‡§§‡•Ä‡§∏‡§∞‡•á ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§™‡§∞ 6 ‡§∏‡•á‡§ï‡§Ç‡§° */
}




        .filters { display: flex; justify-content: center; margin: 20px; gap: 30px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        select { padding: 8px; font-size: 16px; }
        table { width: 100%; margin: 20px auto; border-collapse: collapse; background-color: white; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: center; }
        th { background-color: #007BFF; color: white; }
        .loan { color: red; }
        .payment { color: green; }
        .net-balance { font-weight: bold; }
        tfoot td { font-weight: bold; background-color: #ffe68d ; }
        .positive { color: green; font-size: 18px; }
        .negative { color: red; font-size: 18px; }
        
.results-box {
    display: flex;
    gap: 20px;
    justify-content: center; /* ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§ï‡•ã ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§®‡§æ */
    margin-bottom: 10px;
}

.box {
    background-color: #fff;
    border: 2px solid #007BFF;
    border-radius: 5px;
    padding: 8px 12px;
    text-align: center;
    min-width: 130px;
    font-size: 14px;
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* ‡§π‡§≤‡•ç‡§ï‡§æ ‡§∂‡•à‡§°‡•ã */
}
/* Profile Section */
.profile-section {
    position: fixed; /* ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§´‡§ø‡§ï‡•ç‡§∏‡•ç‡§° ‡§ï‡§∞‡§§‡§æ ‡§π‡•à */
    top: 115px; /* ‡§ä‡§™‡§∞ ‡§∏‡•á 20px ‡§ï‡§æ ‡§∏‡•ç‡§™‡•á‡§∏ */
    left: 50%; /* ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è */
    transform: translateX(-50%); /* ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§∏‡•á‡§Ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡§æ ‡§π‡•à */
    display: flex;
    align-items: center;
    justify-content: flex-start; /* ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§¨‡§æ‡§à‡§Ç ‡§§‡§∞‡§´ ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à */
    padding: 10px;
    background-color: #fff;
    border: 2px solid #007BFF;
    border-radius: 5px; /* ‡§ï‡§ø‡§®‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§•‡•ã‡§°‡§º‡§æ ‡§ó‡•ã‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à */
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    width: 330px; /* ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§∏‡•á‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à */
    height: 70px;
    gap: 20px; /* ‡§™‡§ø‡§ï‡•ç‡§ö‡§∞ ‡§î‡§∞ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§Æ‡•á‡§Ç ‡§ó‡•à‡§™ */
    z-index: 1000; /* ‡§Ö‡§®‡•ç‡§Ø ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏ ‡§ï‡•á ‡§ä‡§™‡§∞ ‡§≤‡§æ‡§§‡§æ ‡§π‡•à */
}

/* Profile Picture */
.profile-picture {
    width: 80px; /* ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§™‡§ø‡§ï‡•ç‡§ö‡§∞ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ */
    height: 80px;
    border-radius: 50%; /* ‡§∏‡§∞‡•ç‡§ï‡•Å‡§≤‡§∞ ‡§≤‡•Å‡§ï */
    background-color: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40px;
    font-weight: bold;
    color: white;
    text-transform: uppercase;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* ‡§™‡§ø‡§ï‡•ç‡§ö‡§∞ ‡§ï‡•á ‡§®‡•Ä‡§ö‡•á ‡§∂‡•à‡§°‡•ã */
    flex-shrink: 0; /* ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•ã ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à */
}

/* ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® ‡§Ö‡§™‡§°‡•á‡§ü */
.profile-section {
    background-color: #056fff;
    border: 1px solid #000;
    border-radius: 5px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    padding-bottom: 10px; /* ‡§®‡•Ä‡§ö‡•á ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ú‡§ó‡§π */
}

/* ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§™‡§ø‡§ï‡•ç‡§ö‡§∞ */
.profile-picture {
    border: 3px solid #fff;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
}

/* ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡•á‡§∏ ‡§¨‡§æ‡§∞ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ */
.progress-bar-container {
    width: 100%;
    height: 10px;
    background-color: #fff; /* ‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° ‡§∏‡§´‡•á‡§¶ */
    border-radius: 9px;
    overflow: hidden;
    margin-top: 5px;
}

/* ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡•á‡§∏ ‡§¨‡§æ‡§∞ */
.progress-bar {
    height: 100%;
    width: 0; /* ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§Æ‡•á‡§Ç ‡§ö‡•å‡§°‡§º‡§æ‡§à 0 */
    transition: width 1s ease-in-out, background-color 0.5s ease-in-out; /* ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§® */
}

/* ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ï‡§≤‡§∞ */
.progress-bar.positive {
    background-color: #05ff00; /* ‡§ó‡•ç‡§∞‡•Ä‡§® */
}

/* ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ï‡§≤‡§∞ */
.progress-bar.negative {
    background-color: #ff0001; /* ‡§∞‡•á‡§° */
}


/* ‡§è‡§®‡§ø‡§Æ‡•á‡§ü‡•á‡§° ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§∞‡§Ç‡§ó */
.animated-text.positive {
    color: #05ff00;
    transition: color 0.5s ease-in-out;
}
/* Profile Details */
.profile-details {
    flex: 1; /* ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§µ‡§æ‡§≤‡•á ‡§≠‡§æ‡§ó ‡§ï‡•ã ‡§´‡•à‡§≤‡§®‡•á ‡§¶‡•á‡§§‡§æ ‡§π‡•à */
}

.profile-details h3 {
    margin-top: -5;
    font-size: 20px;
    color: #fff;
    font-weight: bold;
    text-transform: capitalize;
}

.profile-details p {
    margin: 1px 0 0;
    font-size: 16px;
    font-weight: bold;
    color: #fff;
    line-height: 1;
}


/* ‡§ü‡•á‡§¨‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§ø‡§´‡•â‡§≤‡•ç‡§ü ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
table {
    width: 100%; /* ‡§™‡•Ç‡§∞‡•á ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç */
    margin: 20px auto; /* ‡§ü‡•á‡§¨‡§≤ ‡§ï‡•ã ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡•á‡§Ç */
    border-collapse: collapse; /* ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡•ã ‡§Æ‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç */
    background-color: white;
}

/* ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ (600px ‡§§‡§ï ‡§ï‡•Ä ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®) */
@media only screen and (max-width: 600px) {
    table {
        font-size: 12px; /* ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§∏‡§æ‡§á‡§ú ‡§õ‡•ã‡§ü‡§æ ‡§ï‡§∞‡•á‡§Ç */
    }
    th, td {
        padding: 8px; /* ‡§™‡•à‡§°‡§ø‡§Ç‡§ó ‡§ò‡§ü‡§æ‡§è‡§Ç */
    }
}

/* ‡§ü‡•à‡§¨‡§≤‡•á‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ (600px ‡§∏‡•á 1024px) */
@media only screen and (min-width: 601px) and (max-width: 1024px) {
    table {
        font-size: 14px; /* ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§∏‡§æ‡§á‡§ú ‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§∞‡§ñ‡•á‡§Ç */
    }
    th, td {
        padding: 10px; /* ‡§ü‡•à‡§¨‡§≤‡•á‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§ö‡§ø‡§§ ‡§™‡•à‡§°‡§ø‡§Ç‡§ó */
    }
}

/* ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ (1024px ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§ö‡•å‡§°‡§º‡§æ‡§à) */
@media only screen and (min-width: 1025px) {
    table {
        font-size: 16px; /* ‡§¨‡§°‡§º‡•á ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§∏‡§æ‡§á‡§ú ‡§¨‡§°‡§º‡§æ ‡§∞‡§ñ‡•á‡§Ç */
    }
    th, td {
        padding: 12px; /* ‡§â‡§ö‡§ø‡§§ ‡§™‡•à‡§°‡§ø‡§Ç‡§ó */
    }
}


           
    </style>
</head>
<body>
     <!-- Slider Section -->
    <div class="slider">
        <div class="slides">
            <img src="https://lh3.googleusercontent.com/pw/AP1GczMzEraidh_f2wUVBKNIPxd1SdOQqws0C7LQ3Sqqd01C7eSgjOY-KpAFL7GpAkuxeEC9wyUC8Q77eJwAifbc0CB-gATK-d_I53cT76wvzQIayphn1kosCk_kgoiMLmaiFcXmZSDkxt1Te69uLf92ENMl=w1080-h324-s-no-gm?authuser=0" alt="Slide 1">
            <img src="https://lh3.googleusercontent.com/pw/AP1GczPky9qmGBH3SXUpO-qsKFW1DMJFCPpj8W7TGqvmbwI7U2063Vz0UmW8pNT5Yj84ggQ7na6z9eb2H4wmGuZcheWNNeSnWszAizuOXcReY_156twFFN4sa4DDuWAu3svKlYTWfCVz6w3_OmsJckSoulmY=w1080-h324-s-no-gm?authuser=0" alt="Slide 2">
            <img src="https://lh3.googleusercontent.com/pw/AP1GczPnrbz4OK_mCKZTXZsY3_8kMHhHQd7zfsfyz_OYpdjonMqV_WmFG2Xou2ZUWbNPo7yoO1O1KBzPUazFMkWRa0WCML7A8s6Ay1E-VeI8_ibl107f9zXiabzHeqWfL1o5OYyfNDqeAvnQeTBBZzrneYrH=w1080-h324-s-no-gm?authuser=0" alt="Slide 3">
        </div>
    </div>

<!-- Profile Section -->
<div id="profileSection" class="profile-section">
    <div class="profile-picture"></div>
    <div class="profile-details">
        <h3 id="profileName">Select a name</h3>
        <p>Amount: <span id="profileAmount">0</span></p>
        <p>Balance SCORE: <span id="profileScore">0</span></p>
        <div class="progress-bar-container">
    <div class="progress-bar" id="progressBar"></div>
</div>
    </div>
</div>

<!-- Fullscreen Image Modal -->
<div id="imageModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center;">
    <img id="modalImage" src="" alt="Profile Image" style="max-width: 100%; max-height: 100%; border-radius: 10px;">
</div>




    <div class="filters">
        <div>
            <label for="nameFilter">Select Name:</label>
            <select id="nameFilter"></select>
        </div>
        <!-- Type Filter Dropdown -->
<div>
    <label for="typeFilter">Filter Data By:</label>
    <select id="typeFilter">
        <option value="all">All</option>
        <option value="members_invest">Loan payment</option>
        <option value="loan_history">Loan History</option>
        <option value="emi_payment">EMI Payment</option>
        <option value="Civil Score">Balance Score</option>
    </select>
</div>
    </div>

    <!-- Data Table -->
    <table id="dataTable">
        <thead>
            <tr>
                <th>Date</th>
                <th>Loan</th>
                <th>Payment</th>
                <th>Net Balance</th>
            </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
            <tr>
                <td>Total</td>
                <td id="totalLoan">0</td>
                <td id="totalPayment">0</td>
                <td id="totalNetBalance" class="positive">0</td>
            </tr>
        </tfoot>
    </table>

    <!-- JavaScript -->
<script>
    let data = [];

    const commonUrl = 'https://script.google.com/macros/s/AKfycbyzs5UbjLWv9U-JBiT87iTd8Pbgy2yxYUI8vsiiiQ7zkFNF7L5t49aBZOnsFgvK4GZc2A/exec';

    // ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    async function fetchData() {
        const response = await fetch(commonUrl);
        data = await response.json();
        populateNameFilter();
        filterData();
    }

    // ‡§®‡§æ‡§Æ ‡§ï‡§æ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
    function populateNameFilter() {
        const nameFilter = document.getElementById('nameFilter');
        const uniqueNames = [...new Set(data.map(row => row.Name))];
        nameFilter.innerHTML = '<option value="all">All</option>';
        uniqueNames.forEach(name => {
            nameFilter.innerHTML += `<option value="${name}">${name}</option>`;
        });
    }

    // ‡§ü‡•á‡§¨‡§≤ ‡§π‡•á‡§°‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    function updateTableHeader(typeFilter) {
        const tableHead = document.querySelector('#dataTable thead');
        const headers = {
            "civil_score": ["#", "Name", "BALANCE SCORE", "Amount"],
            "loan_history": ["Date", "Loan", "Payment", "Net Balance"],
            "emi_payment": ["Date", "Loan", "EMI Payment", "Net Balance"],
            "members_invest": ["Date", "Loan", "Payment", "Net Balance"],
           "default": ["Date", "Loan", "Payment", "Net Balance"]
        };
        
        const currentHeaders = headers[typeFilter] || headers["default"];
        tableHead.innerHTML = `<tr>${currentHeaders.map(h => `<th>${h}</th>`).join('')}</tr>`;
    }

    // ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§î‡§∞ ‡§°‡§ø‡§∏‡•ç‡§™‡•ç‡§≤‡•á ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    function filterData() {
    const nameFilter = document.getElementById('nameFilter').value;
    const typeFilter = document.getElementById('typeFilter').value;

    let filteredData = [];

    if (nameFilter === "all" && typeFilter === "all") {
        // Loan history, Members invest ‡§î‡§∞ EMI payment ‡§ï‡§æ ‡§Æ‡§∞‡•ç‡§ú ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•Å‡§Ü ‡§°‡•á‡§ü‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
        const loanData = data.filter(row => parseFloat(row.Loan) > 0)
            .map(row => ({ ...row, IsEmi: false }));
        const paymentData = data.filter(row => parseFloat(row.Payment) > 0)
            .map(row => ({ ...row, IsEmi: false }));
        const emiData = data.filter(row => parseFloat(row[" EMI payment"] || 0) > 0)
            .map(row => ({
                Date: row.Date,
                Loan: 0,
                Payment: parseFloat(row[" EMI payment"] || 0),
                Name: row.Name,
                IsEmi: true
            }));
        filteredData = [...loanData, ...paymentData, ...emiData];
    } 
    else if (nameFilter === "all" && typeFilter === "loan_history") {
        // ‡§∏‡§≠‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ Loan Amount ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
        filteredData = data.filter(row => parseFloat(row.Loan) > 0)
            .map(row => ({
                Date: row.Date,
                Loan: parseFloat(row.Loan),
                Payment: 0,
                Name: row.Name
            }));
    } 
    else if (nameFilter === "all" && typeFilter === "members_invest") {
        // ‡§∏‡§≠‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ Payment Loan ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
        filteredData = data.filter(row => parseFloat(row.Payment) > 0)
            .map(row => ({
                Date: row.Date,
                Loan: 0,
                Payment: parseFloat(row.Payment),
                Name: row.Name
            }));
    } 
    else if (nameFilter === "all" && typeFilter === "emi_payment") {
        // ‡§∏‡§≠‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ EMI payment ‡§°‡•á‡§ü‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
        filteredData = data.filter(row => parseFloat(row[" EMI payment"] || 0) > 0)
            .map(row => ({
                Date: row.Date,
                Loan: 0,
                Payment: parseFloat(row[" EMI payment"] || 0),
                Name: row.Name,
                IsEmi: true
            }));
    } 
    else if (nameFilter !== "all") {
        // ‡§ú‡§¨ ‡§ï‡§ø‡§∏‡•Ä ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡§æ‡§Æ ‡§ï‡•ã ‡§ö‡•Å‡§®‡§æ ‡§ú‡§æ‡§è
        if (typeFilter === "loan_history") {
            filteredData = data.filter(row => row.Name === nameFilter && parseFloat(row.Loan) > 0);
        } else if (typeFilter === "members_invest") {
            filteredData = data.filter(row => row.Name === nameFilter && parseFloat(row.Payment) > 0);
            
        } else if (typeFilter === "Civil Score") {
    updateTableHeader("civil_score");
    displayCivilScore();
}

        else if (typeFilter === "emi_payment") {
            filteredData = data.filter(row => row.Name === nameFilter && parseFloat(row[" EMI payment"] || 0) > 0)
                .map(row => ({
                    Date: row.Date,
                    Loan: 0,
                    Payment: parseFloat(row[" EMI payment"] || 0),
                    IsEmi: true
                }));
                
        } else if (typeFilter === "all") {
            const loanData = data.filter(row => row.Name === nameFilter && parseFloat(row.Loan) > 0);
            const paymentData = data.filter(row => row.Name === nameFilter && parseFloat(row.Payment) > 0);
            const emiData = data.filter(row => row.Name === nameFilter && parseFloat(row[" EMI payment"] || 0) > 0)
                .map(row => ({
                    Date: row.Date,
                    Loan: 0,
                    Payment: parseFloat(row[" EMI payment"] || 0),
                    IsEmi: true
                }));
            filteredData = [...loanData, ...paymentData, ...emiData];
        }
    }

    updateTableHeader(typeFilter);
    displayData(filteredData);
}
function displayData(filteredData) {
    const tableBody = document.querySelector("#dataTable tbody");
    tableBody.innerHTML = "";

    let loanSum = 0, paymentSum = 0;

    filteredData.sort((a, b) => new Date(a.Date) - new Date(b.Date));

    filteredData.forEach(row => {
        const loan = parseFloat(row.Loan) || 0;
        const payment = parseFloat(row.Payment) || 0;

        const netBalance = payment - loan;
        loanSum += loan;
        paymentSum += payment;

        // EMI ‡§ï‡§æ ‡§ü‡•à‡§ó ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
        const emiTag = row.IsEmi ? `<span style="background-color: green; color: white; padding: 2px 5px;">EMI</span>` : '';

        tableBody.innerHTML += `
            <tr>
                <td>${formatDate(row.Date)}</td>
                <td>${loan || ""}</td>
                <td>${payment || ""} ${emiTag}</td>
                <td>${row.Name || ""}</td>
                <td>${netBalance}</td>
            </tr>
        `;
    });

    updateTotals(loanSum, paymentSum);
}

// ‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§≤‡•ã‡§® ‡§≤‡•á‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§î‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function checkRecentStatus() {
    const recentRows = {}; // ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡§æ ‡§∞‡•Ä‡§∏‡•á‡§Ç‡§ü ‡§≤‡•ã‡§® ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§π‡•ã‡§ó‡§æ
    const today = new Date(); // ‡§™‡•ç‡§∞‡•á‡§ú‡•á‡§Ç‡§ü ‡§°‡•á‡§ü

    // Step 1: ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§®‡§æ‡§Æ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç
    const groupedData = {};
    data.forEach(row => {
        const name = row.Name.trim();
        if (!groupedData[name]) {
            groupedData[name] = [];
        }
        groupedData[name].push({ ...row, Date: new Date(row.Date) }); // Date ‡§ï‡•ã Date object ‡§Æ‡•á‡§Ç ‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
    });

    // Step 2: ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§è‡§®‡§æ‡§≤‡§ø‡§∏‡§ø‡§∏ ‡§ï‡§∞‡•á‡§Ç
    Object.keys(groupedData).forEach(name => {
        const records = groupedData[name];

        // Step 3: ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§°‡•á‡§ü ‡§ï‡•á ‡§π‡§ø‡§∏‡§æ‡§¨ ‡§∏‡•á DESCENDING ‡§ï‡•ç‡§∞‡§Æ ‡§Æ‡•á‡§Ç ‡§∏‡•â‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§∏‡§¨‡§∏‡•á ‡§™‡§π‡§≤‡•á)
        records.sort((a, b) => b.Date - a.Date);

        let foundLoan = false; // ‡§∏‡§¨‡§∏‡•á ‡§∞‡•Ä‡§∏‡•á‡§Ç‡§ü ‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡•ç‡§≤‡•à‡§ó

        // Step 4: ‡§™‡•ç‡§∞‡•á‡§ú‡•á‡§Ç‡§ü ‡§°‡•á‡§ü ‡§∏‡•á ‡§†‡•Ä‡§ï ‡§™‡•Ä‡§õ‡•á ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç
        for (let i = 0; i < records.length; i++) {
            const current = records[i];

            const currentLoan = parseFloat(current.Loan) || 0;
            const currentPayment = parseFloat(current.Payment) || 0;
            const currentEmi = parseFloat(current[" EMI payment"]) || 0;

            // EMI ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§á‡§ó‡•ç‡§®‡•ã‡§∞ ‡§ï‡§∞‡•á‡§Ç
            if (currentEmi > 0) {
                continue;
            }

            // ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§Æ‡§ø‡§≤‡§®‡•á ‡§™‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§® ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§ó‡§≤‡•á ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç
            if (currentPayment > 0) {
                break; // ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§Æ‡§ø‡§≤ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ñ‡§§‡•ç‡§Æ ‡§ï‡§∞‡•á‡§Ç
            }

            // ‡§≤‡•ã‡§® ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§≤‡§æ
            if (currentLoan > 0) {
                recentRows[name] = current; // ‡§≤‡•ã‡§® ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡•á‡§Ç
                foundLoan = true;
                break; // ‡§ï‡•á‡§µ‡§≤ ‡§™‡§π‡§≤‡§æ ‡§∏‡§π‡•Ä ‡§≤‡•ã‡§® ‡§π‡•Ä ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç
            }
        }
    });

    // Step 5: ‡§ü‡•á‡§¨‡§≤ ‡§Æ‡•á‡§Ç ‡§∞‡•Ä‡§∏‡•á‡§Ç‡§ü ‡§≤‡•ã‡§® ‡§µ‡§æ‡§≤‡•á ‡§∞‡•ã ‡§ï‡•ã ‡§π‡§æ‡§á‡§≤‡§æ‡§á‡§ü ‡§ï‡§∞‡•á‡§Ç
    const tableRows = document.querySelectorAll("#dataTable tbody tr");
    tableRows.forEach(row => {
        const cells = row.querySelectorAll("td");
        if (cells.length > 0) {
            const memberName = cells[3]?.textContent?.trim();
            const rowDate = new Date(cells[0]?.textContent?.trim());

            // ‡§∞‡•Ä‡§∏‡•á‡§Ç‡§ü ‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§π‡§æ‡§á‡§≤‡§æ‡§á‡§ü ‡§ï‡§∞‡•á‡§Ç
            if (
                recentRows[memberName] &&
                recentRows[memberName].Date.getTime() === rowDate.getTime()
            ) {
                row.style.backgroundColor = "rgba(255, 0, 0, 0.2)"; // ‡§π‡§≤‡•ç‡§ï‡§æ ‡§∞‡•á‡§° ‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§°
            } else {
                row.style.backgroundColor = ""; // ‡§Ö‡§®‡•ç‡§Ø ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç
            }
        }
    });
}

// displayData() ‡§Æ‡•á‡§Ç ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç
function displayData(filteredData) {
    const tableBody = document.querySelector("#dataTable tbody");
    tableBody.innerHTML = "";

    let loanSum = 0, paymentSum = 0;

    // ‡§°‡•á‡§ü ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§∏‡•â‡§∞‡•ç‡§ü‡§ø‡§Ç‡§ó
    filteredData.sort((a, b) => new Date(a.Date) - new Date(b.Date));

    filteredData.forEach(row => {
        const loan = parseFloat(row.Loan) || 0;
        const payment = parseFloat(row.Payment) || 0;

        const netBalance = payment - loan;
        loanSum += loan;
        paymentSum += payment;

        tableBody.innerHTML += `
            <tr>
                <td>${formatDate(row.Date)}</td>
                <td>${loan || ""}</td>
                <td>${payment || ""}</td>
                <td>${row.Name || ""}</td>
                <td>${netBalance}</td>
            </tr>
        `;
    });

    updateTotals(loanSum, paymentSum);

    // ‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§ï‡•á ‡§≤‡•ã‡§® ‡§µ‡§æ‡§≤‡•á ‡§∞‡•ã ‡§ï‡•ã ‡§π‡§æ‡§á‡§≤‡§æ‡§á‡§ü ‡§ï‡§∞‡•á‡§Ç
    checkRecentStatus();
}

// Helper function: Date ‡§ï‡•ã DD-MM-YYYY ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è
function formatDate(dateStr) {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });
}

// Civil Score ‡§ë‡§™‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§î‡§∞ ‡§ü‡•á‡§¨‡§≤ ‡§Æ‡•á‡§Ç ‡§°‡§ø‡§∏‡•ç‡§™‡•ç‡§≤‡•á ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function displayCivilScoreData() {
    const tableBody = document.querySelector("#dataTable tbody");
    const totalCibilScore = document.getElementById("totalPayment");
    const totalAmount = document.getElementById("totalNetBalance");
    const memberCountElement = document.getElementById("totalLoan");
    const nameFilter = document.getElementById("nameFilter").value;

    tableBody.innerHTML = "";

    let totalCibilSum = 0;
    let totalAmountSum = 0;
    let totalMembers = 0;

    const userData = {};

    // ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó
    data.forEach(row => {
        const name = row.Name.trim();
        const loan = parseFloat(row.Loan) || 0;
        const payment = parseFloat(row.Payment) || 0;
        const emiPayment = parseFloat(row[" EMI payment"] || 0);

        const amount = (emiPayment + payment) - loan;

        if (!userData[name]) {
            userData[name] = { amount: 0 };
            totalMembers++;
        }

        userData[name].amount += amount;
    });

    // CIBIL ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç ‡§î‡§∞ ‡§∏‡•â‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
    const sortedData = Object.entries(userData).map(([name, { amount }]) => {
        const civilScore = Math.min(1000, Math.max(-1000, amount / 10));
        totalCibilSum += civilScore;
        totalAmountSum += amount;
        return { name, civilScore, amount };
    }).sort((a, b) => b.civilScore - a.civilScore);

    // ‡§ü‡•á‡§¨‡§≤ ‡§Æ‡•á‡§Ç ‡§°‡•á‡§ü‡§æ ‡§°‡§ø‡§∏‡•ç‡§™‡•ç‡§≤‡•á ‡§ï‡§∞‡•á‡§Ç
    sortedData.forEach((user, index) => {
        const isSelectedName = nameFilter !== "all" && user.name === nameFilter;
        const backgroundColor = user.amount < 0 ? 'rgba(255, 0, 0, 0.2)' : '#d1ffcf';

        // ‡§á‡§Æ‡•ã‡§ú‡•Ä ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
        let serialNumber = index + 1;
        if (index === 0) serialNumber = "ü•á";
        else if (index === 1) serialNumber = "ü•à";
        else if (index === 2) serialNumber = "ü•â";

        tableBody.innerHTML += `
            <tr style="${isSelectedName ? `font-weight: bold; background-color: ${backgroundColor};` : ''}">
                <td>${serialNumber}</td>
                <td>${user.name}</td>
                <td style="color: ${user.civilScore < 0 ? 'red' : '#017203'};">${user.civilScore}</td>
                <td>${user.amount.toFixed(2)}</td>
            </tr>
        `;
    });

    // ‡§ü‡•ã‡§ü‡§≤ ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
    totalCibilScore.textContent = totalCibilSum.toFixed(2);
    totalAmount.textContent = totalAmountSum.toFixed(2);
    memberCountElement.textContent = `${totalMembers} Members`;
}


// ‡§ü‡§æ‡§á‡§™ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§î‡§∞ ‡§®‡§æ‡§Æ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§á‡§µ‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
function handleFilterChange() {
    const typeFilter = document.getElementById("typeFilter").value;

    if (typeFilter === "Civil Score") {
        updateTableHeader("civil_score"); // ‡§∏‡§π‡•Ä ‡§π‡•á‡§°‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
        displayCivilScoreData(); // CIBIL ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§°‡•á‡§ü‡§æ ‡§°‡§ø‡§∏‡•ç‡§™‡•ç‡§≤‡•á ‡§ï‡§∞‡•á‡§Ç
    } else {
        filterData(); // ‡§Ö‡§®‡•ç‡§Ø ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç
    }
}

// ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞‡•ç‡§∏
document.getElementById("typeFilter").addEventListener("change", handleFilterChange);
document.getElementById("nameFilter").addEventListener("change", handleFilterChange);

// ‡§™‡•á‡§ú ‡§≤‡•ã‡§° ‡§™‡§∞ Default Civil Score ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è
document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("typeFilter").value = "Civil Score";
    document.getElementById("nameFilter").value = "all"; // Default "all" ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
    handleFilterChange();
});
    // ‡§ü‡•ã‡§ü‡§≤ ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
    function updateTotals(loan, payment) {
        document.getElementById("totalLoan").textContent = loan;
        document.getElementById("totalPayment").textContent = payment;
        const netBalance = payment - loan;
        const totalNetBalance = document.getElementById("totalNetBalance");
        totalNetBalance.textContent = netBalance;
        totalNetBalance.className = netBalance < 0 ? "negative" : "positive";
    }

    // ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§°‡•á‡§ü
    function formatDate(dateStr) {
        const date = new Date(dateStr);
        return date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });
    }

    // ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞‡•ç‡§∏
    document.getElementById('nameFilter').addEventListener('change', filterData);
    document.getElementById('typeFilter').addEventListener('change', filterData);

    // ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç
    fetchData();
    
        // ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§Æ‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç (‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§á‡§Æ‡•á‡§ú URL)
    const profileData = [
        { name: "Prince Rama", image: "https://bit.ly/49GvZh4" },
        { name: "Amit Kumar", image: "https://bit.ly/4gzlMFs" },
        { name: "Mithlesh Sahni", image: "https://bit.ly/3ZCGptv" },
        { name: "Raja Sahni", image: "https://bit.ly/3ZEnwGK" },
        { name: "Dilkhush Kumar", image: "https://bit.ly/4iTxRrh" },
        { name: "Nitish Sahni", image: "https://bit.ly/3BxVjcw" },
        { name: "Kunal kumar", image: "https://bit.ly/49H7tMO" },
        { name: "Dr Santosh", image: "https://bit.ly/3BBiGC3" }
    ];

    // ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    // Animation function to increment a value smoothly
function animateValue(element, start, end, duration, unit = "") {
    let startTime = null;

    function step(currentTime) {
        if (!startTime) startTime = currentTime;
        const progress = Math.min((currentTime - startTime) / duration, 1);
        const value = Math.floor(progress * (end - start) + start);
        element.textContent = value + unit;

        if (progress < 1) {
            requestAnimationFrame(step);
        }
    }

    requestAnimationFrame(step);
}

function updateProfileSection(name, typeFilter = "all") {
    const profileName = document.getElementById("profileName");
    const profileAmount = document.getElementById("profileAmount");
    const profileScore = document.getElementById("profileScore");
    const progressBar = document.getElementById("progressBar");
    const profilePicture = document.querySelector(".profile-picture");

    if (name === "all" && typeFilter === "all") {
        const totalEmiPayment = data.reduce((acc, row) => acc + (parseFloat(row[" EMI payment"]) || 0), 0);
        const totalPayment = data.reduce((acc, row) => acc + (parseFloat(row.Payment) || 0), 0);
        const totalLoan = data.reduce((acc, row) => acc + (parseFloat(row.Loan) || 0), 0);
        const availableBalance = (totalEmiPayment + totalPayment) - totalLoan;

        profileName.textContent = "Available Balance";
        animateValue(profileAmount, 0, availableBalance, 1000, "");
        profileScore.textContent = "";
        progressBar.style.width = "0%";
        progressBar.style.backgroundColor = "transparent";
        profilePicture.innerHTML = "";
        return;
    }
    
    const userData = data.filter(row => row.Name.trim().toLowerCase() === name.trim().toLowerCase());
    const userProfile = profileData.find(profile => profile.name.trim().toLowerCase() === name.trim().toLowerCase());

    if (userData.length > 0) {
        const totalEmiPayment = userData.reduce((acc, row) => acc + (parseFloat(row[" EMI payment"]) || 0), 0);
        const totalPayment = userData.reduce((acc, row) => acc + (parseFloat(row.Payment) || 0), 0);
        const totalLoan = userData.reduce((acc, row) => acc + (parseFloat(row.Loan) || 0), 0);
        const amount = (totalEmiPayment + totalPayment) - totalLoan;
        const civilScore = Math.min(700, Math.max(-700, amount / 10));

        profileName.textContent = name;

        animateValue(profileAmount, 0, amount, 1000, "");
        animateValue(profileScore, 0, civilScore, 1000, "");

        profileScore.style.color = civilScore < 0 ? "red" : "#13ff00";
        progressBar.style.width = `${Math.abs(civilScore / 7)}%`;
        progressBar.style.backgroundColor = civilScore < 0 ? "red" : "#13ff00";

        const profileImageUrl = userProfile ? userProfile.image : 'https://via.placeholder.com/100';
        profilePicture.innerHTML = `
            <img src="${profileImageUrl}" alt="Profile Image" style="width: 80px; height: 80px; border-radius: 50%; cursor: pointer;">
        `;
        
        document.querySelector(".profile-picture img").addEventListener("click", () => {
            const modal = document.getElementById("imageModal");
            const modalImage = document.getElementById("modalImage");
            modalImage.src = profileImageUrl;
            modal.style.display = "flex";
        });
    } else {
        profileName.textContent = "Select a name";
        profileAmount.textContent = "0";
        profileScore.textContent = "0";
        progressBar.style.width = "0%";
        progressBar.style.backgroundColor = "transparent";
        profilePicture.innerHTML = "";
    }
}
    // ‡§á‡§Æ‡•á‡§ú ‡§Æ‡•ã‡§°‡§≤ ‡§ï‡•ã ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§á‡§µ‡•á‡§Ç‡§ü
    document.getElementById("imageModal").addEventListener("click", () => {
        document.getElementById("imageModal").style.display = "none";
    });

    // ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§ü‡§æ‡§á‡§™ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§™‡§∞ ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞
    document.getElementById("nameFilter").addEventListener("change", () => {
        const nameFilter = document.getElementById("nameFilter").value;
        const typeFilter = document.getElementById("typeFilter").value;
        updateProfileSection(nameFilter, typeFilter);
    });

    document.getElementById("typeFilter").addEventListener("change", () => {
        const nameFilter = document.getElementById("nameFilter").value;
        const typeFilter = document.getElementById("typeFilter").value;
        updateProfileSection(nameFilter, typeFilter);
    });

    // ‡§®‡§æ‡§Æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§™‡•ç‡§∞‡•Ä-‡§™‡•â‡§™‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü ‡§ï‡§∞‡§®‡§æ
    function populateNameFilter() {
    const nameFilter = document.getElementById("nameFilter");
    const memberData = {};

    // ‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§â‡§®‡§ï‡§æ ‡§ï‡•Å‡§≤ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç
    data.forEach(row => {
        const name = row.Name.trim();
        const loan = parseFloat(row.Loan) || 0;
        const payment = parseFloat(row.Payment) || 0;
        const emiPayment = parseFloat(row[" EMI payment"] || 0);

        if (!memberData[name]) {
            memberData[name] = 0; // Initialize balance
        }

        memberData[name] += (payment + emiPayment) - loan; // ‡§ï‡•Å‡§≤ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏
    });

    // ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§â‡§®‡§ï‡•á ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∏‡•â‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (Descending order)
    const sortedMembers = Object.entries(memberData).sort((a, b) => b[1] - a[1]);

    // ‡§®‡§æ‡§Æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
    nameFilter.innerHTML = '<option value="all">All</option>';
    sortedMembers.forEach(([name]) => {
        nameFilter.innerHTML += `<option value="${name}">${name}</option>`;
    });

    // ‡§∏‡§¨‡§∏‡•á ‡§™‡§π‡§≤‡§æ ‡§ë‡§™‡•ç‡§∂‡§® ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç (Highest Balance)
    if (sortedMembers.length > 0) {
        nameFilter.value = sortedMembers[0][0];
        updateProfileSection(sortedMembers[0][0]);
    }
}

    // ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§®‡§æ‡§Æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§≠‡§∞‡•á‡§Ç
    document.addEventListener("DOMContentLoaded", () => {
        populateNameFilter();
    });
    
// ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®: ‡§ü‡•ã‡§ü‡§≤ ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ, ‡§∏‡•â‡§∞‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó
function calculateTotalReturn() {
    const tableBody = document.querySelector("#dataTable tbody");
    const totalLoanElement = document.getElementById("totalLoan");
    const totalPaymentElement = document.getElementById("totalPayment");
    const totalNetBalanceElement = document.getElementById("totalNetBalance");
    tableBody.innerHTML = "";

    let overallLoanSum = 0, overallPaymentSum = 0, overallReturnSum = 0;

    // ‡§∏‡§≠‡•Ä ‡§Æ‡•á‡§Ç‡§¨‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§Ç
    const members = [...new Set(data.map(row => row.Name.trim()))];
    const memberResults = members.map(member => {
        // ‡§Æ‡•á‡§Ç‡§¨‡§∞ ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç
        const memberData = data.filter(row => row.Name.trim() === member);

        // ‡§π‡§æ‡§≤‡§ø‡§Ø‡§æ ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç (excluding EMI payments)
        const recentPaymentDate = memberData
            .filter(row => parseFloat(row.Payment) > 0) // ‡§ï‡•á‡§µ‡§≤ ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¶‡•á‡§ñ‡•á‡§Ç
            .reduce((latest, row) => {
                const date = new Date(row.Date);
                return date > latest ? date : latest;
            }, new Date(0));

        // ‡§π‡§æ‡§≤‡§ø‡§Ø‡§æ ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡§≠‡•Ä ‡§≤‡•ã‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
        const totalLoan = memberData
            .filter(row => new Date(row.Date) <= recentPaymentDate && parseFloat(row.Loan) > 0) // ‡§π‡§æ‡§≤‡§ø‡§Ø‡§æ ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§∏‡•á ‡§™‡§π‡§≤‡•á
            .reduce((sum, row) => sum + parseFloat(row.Loan), 0);

        // ‡§∏‡§≠‡•Ä ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ú‡•ã‡§°‡§º‡•á‡§Ç (excluding EMI payments)
        const totalPayment = memberData
            .filter(row => parseFloat(row.Payment) > 0) // ‡§ï‡•á‡§µ‡§≤ ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
            .reduce((sum, row) => sum + parseFloat(row.Payment), 0);

        // ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ
        const totalReturn = totalPayment - totalLoan;

        // ‡§ï‡•Å‡§≤ ‡§Ø‡•ã‡§ó ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
        overallLoanSum += totalLoan;
        overallPaymentSum += totalPayment;
        overallReturnSum += totalReturn;

        return {
            member,
            totalLoan,
            totalPayment,
            totalReturn
        };
    });

    // ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§Ö‡§Æ‡§æ‡§â‡§Ç‡§ü ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§∏‡•â‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (Descending Order)
    memberResults.sort((a, b) => b.totalReturn - a.totalReturn);

    // ‡§ü‡•á‡§¨‡§≤ ‡§Æ‡•á‡§Ç ‡§°‡•á‡§ü‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
    memberResults.forEach(({ member, totalLoan, totalPayment, totalReturn }) => {
        tableBody.innerHTML += `
            <tr>
                <td>${member}</td>
                <td>${totalLoan.toFixed(2)}</td>
                <td>${totalPayment.toFixed(2)}</td>
                <td style="color: green; font-weight: bold;">${totalReturn.toFixed(2)}</td>
            </tr>
        `;
    });

    // ‡§ü‡•á‡§¨‡§≤ ‡§ï‡•á ‡§®‡•Ä‡§ö‡•á ‡§ï‡•Å‡§≤ ‡§Ø‡•ã‡§ó ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
    totalLoanElement.textContent = overallLoanSum.toFixed(2);
    totalPaymentElement.textContent = overallPaymentSum.toFixed(2);
    totalNetBalanceElement.textContent = overallReturnSum.toFixed(2);
}

// ‡§ü‡§æ‡§á‡§™ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç 'Total Return' ‡§ë‡§™‡•ç‡§∂‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
document.addEventListener("DOMContentLoaded", () => {
    const typeFilter = document.getElementById("typeFilter");
    const option = document.createElement("option");
    option.value = "total_return";
    option.textContent = "Total Return";
    typeFilter.appendChild(option);
});

// ‡§ü‡§æ‡§á‡§™ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ö‡•á‡§Ç‡§ú ‡§á‡§µ‡•á‡§Ç‡§ü ‡§™‡§∞ 'Total Return' ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç
document.getElementById("typeFilter").addEventListener("change", () => {
    const typeFilter = document.getElementById("typeFilter").value;
    if (typeFilter === "total_return") {
        calculateTotalReturn();
    }
});

    
</script>
</body>
</html>
