<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>बैंक कम्युनिटी लोन</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            text-align: center;
            overflow-x: hidden; /* पेज को साइड में स्क्रॉल होने से रोकें */
            touch-action: pan-y; /* केवल वर्टिकल स्क्रॉल की अनुमति दें */
            overscroll-behavior: contain; /* ओवरस्क्रॉल बिहेवियर को कंट्रोल करें */
        }

        header {
            background-color: #007bff;
            color: white;
            padding: 20px 0;
        }

        /* Header Image Slider */
        .slider {
            width: 100%;
            max-width: 600px; /* Adjust max-width as needed */
            height: auto;
            margin: 0 auto;
            text-align: center;
            overflow: hidden; /* Ensure image doesn't overflow */
        }

        .slider img {
            width: 100%;
            height: auto; /* Maintain aspect ratio */
            display: block; /* Remove extra space below image */
        }

        h1 {
            color: #fff; /* Default for header */
            margin: 10px 0;
            padding: 0 10px; /* Add padding for smaller screens */
        }

        p {
            margin: 10px 0;
            color: #000;
            padding: 0 15px; /* Add padding for readability */
        }

        /* --- Circle Button Container --- */
        .circle-container {
            position: relative;
            width: 280px; /* Slightly smaller for better fit */
            height: 280px;
            margin: 30px auto;
            border-radius: 50%;
            background: #0056b3;
            animation: rotate 15s linear infinite; /* Slower rotation */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .circle-container .button { /* Specificity */
            position: absolute;
            width: 100px; /* Smaller buttons */
            height: 100px;
            border-radius: 50%;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease;
            display: flex;
            flex-direction: column; /* Icon above text */
            justify-content: center;
            align-items: center;
            font-size: 12px; /* Smaller font */
            text-align: center;
            transform-origin: center center;
            padding: 5px; /* Add padding */
            box-sizing: border-box;
        }

         .circle-container .button img {
            width: 30px; /* Smaller icons */
            height: 30px;
            margin-bottom: 5px; /* Space between icon and text */
            margin-right: 0; /* Reset margin */
        }

        .circle-container .button:hover {
            background-color: #004494; /* Darker hover */
            transform: scale(1.1);
        }

        .circle-container .button:active {
            transform: scale(0.95);
        }

        .circle-container .whatsapp-button {
            background-color: #25D366;
        }
        .circle-container .whatsapp-button:hover {
            background-color: #128C7E;
        }

        /* Positioning buttons within the circle */
        .circle-container .top { top: 5%; left: 50%; transform: translate(-50%, -50%); }
        .circle-container .right { top: 50%; right: 5%; transform: translate(50%, -50%); }
        .circle-container .bottom { bottom: 5%; left: 50%; transform: translate(-50%, 50%); }
        .circle-container .left { top: 50%; left: 5%; transform: translate(-50%, -50%); }


        /* --- Features Section --- */
        .features {
            display: flex;
            justify-content: space-around; /* Better spacing */
            margin: 20px auto;
            flex-wrap: wrap;
            max-width: 900px; /* Limit width */
            padding: 0 10px;
        }

        .feature {
            background: white;
            padding: 15px; /* Adjust padding */
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            width: calc(50% - 20px); /* Two columns on medium screens */
            margin: 10px;
            box-sizing: border-box; /* Include padding in width */
        }

        .feature h3 {
            color: #007bff;
            margin-top: 0;
            font-size: 1.1em;
        }

        .feature p {
            color: #555;
            font-size: 0.95em;
            padding: 0; /* Reset padding inherited from body p */
        }

         /* --- Loan Calculator & Feedback --- */
        .loan-calculator, .feedback-form {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            width: 90%; /* Responsive width */
            max-width: 500px; /* Max width */
            box-sizing: border-box;
        }

        .loan-calculator h2, .feedback-form h2 {
            margin-top: 0;
            color: #333;
        }

        .loan-calculator input, .loan-calculator select, .feedback-form input, .feedback-form textarea {
            width: 100%; /* Full width */
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; /* Include padding in width */
            font-size: 1em;
        }

        /* General Button Style (non-circle) */
        .general-button, .loan-calculator button, .feedback-form button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            margin: 5px; /* Add some margin */
        }

         .general-button:hover, .loan-calculator button:hover, .feedback-form button:hover {
            background-color: #0056b3;
        }

        .loan-calculator .toggle-button { /* Specific toggle button style */
             background-color: #555; /* Different color */
        }
         .loan-calculator .toggle-button:hover {
             background-color: #333;
        }


        #loanResult {
            margin-top: 15px;
            font-weight: bold;
            color: #0056b3;
        }


        /* --- About Community Letter Slider --- */
        .slider-container {
            position: relative;
            max-width: 400px; /* Adjust as needed */
            margin: 20px auto;
            overflow: hidden;
            border: 1px solid #ddd;
            border-radius: 8px; /* Softer edges */
            background-color: white; /* Background for slides */
        }

        .slides {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }

        .slide {
            min-width: 100%;
            box-sizing: border-box;
        }

        .slide img {
            width: 100%;
            display: block; /* Remove extra space */
            border-radius: 8px; /* Match container radius */
        }

        /* Slider Navigation Buttons */
        .prev, .next {
            cursor: pointer;
            position: absolute;
            top: 50%; /* Vertically center */
            transform: translateY(-50%);
            width: auto;
            padding: 12px; /* Adjust padding */
            color: white;
            font-weight: bold;
            font-size: 20px; /* Adjust size */
            background-color: rgba(0, 0, 0, 0.4); /* Semi-transparent background */
            border: none;
            border-radius: 5px;
            user-select: none;
            transition: background-color 0.3s ease;
        }
        .prev:hover, .next:hover {
             background-color: rgba(0, 0, 0, 0.7);
        }

        .prev { left: 10px; } /* Position buttons */
        .next { right: 10px; }

        /* Slider Indicator Dots */
        .slide-indicator {
            text-align: center;
            margin-top: 10px;
        }

        .indicator-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            background-color: #bbb;
            border-radius: 50%;
            margin: 0 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .indicator-dot.active {
            background-color: #555; /* Darker active dot */
        }


        /* --- Bank Members Section --- */
        .bank-members {
            background: #e0f7fa; /* Light cyan background */
            padding: 15px 0; /* Vertical padding */
            margin-top: 20px;
            width: 100%; /* Full width */
            box-sizing: border-box;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px 10px 15px; /* Padding around header */
            flex-wrap: wrap; /* Wrap if needed on small screens */
        }

        .bank-headline { /* Style for "BANK MEMBERS" */
            font-size: 1.4em; /* Adjust size */
            font-weight: bold;
            color: #007bff; /* Blue color */
            margin: 0; /* Remove default margin */
            flex-grow: 1; /* Allow it to take space */
        }

        .view-balance {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            background-color: #fff; /* White background */
            padding: 8px 15px; /* Adjust padding */
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em; /* Adjust font size */
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            color: #333; /* Dark text color */
            border: 1px solid #eee; /* Light border */
            margin-top: 5px; /* Add margin if wraps */
        }

        .view-balance:hover {
            transform: translateY(-2px); /* Slight lift */
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .view-balance img.balance-icon {
            width: 20px; /* Icon size */
            height: 20px;
        }

        .member-slider {
            display: flex;
            gap: 10px; /* Space between cards */
            overflow-x: auto; /* Enable horizontal scroll */
            scroll-behavior: smooth;
            padding: 10px 15px; /* Padding for scrollable area */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            scrollbar-width: thin; /* For Firefox */
            scrollbar-color: #007bff #e0f7fa; /* Scrollbar colors */
        }
        /* Simple scrollbar for WebKit browsers */
        .member-slider::-webkit-scrollbar {
             height: 5px;
        }
        .member-slider::-webkit-scrollbar-track {
             background: #e0f7fa;
        }
        .member-slider::-webkit-scrollbar-thumb {
             background-color: #007bff;
             border-radius: 10px;
        }

        .member-card {
            position: relative;
            background-color: #ffffff; /* White card */
            border-radius: 10px; /* Rounded corners */
            flex: 0 0 calc(45% - 10px); /* Adjust width for ~2 cards on mobile */
            max-width: 160px; /* Max width */
            text-align: center;
            padding: 10px; /* Internal padding */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border: 1px solid #eee; /* Light border */
            box-sizing: border-box;
        }

        .member-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .member-card img {
            width: 100%;
            height: 120px; /* Fixed height */
            border-radius: 8px; /* Rounded image corners */
            object-fit: cover; /* Crop image nicely */
            margin-bottom: 8px; /* Space below image */
            display: block; /* Prevent extra space */
        }

        .member-name {
            font-size: 0.9em;
            font-weight: bold;
            margin: 5px 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis; /* Show ... if name is too long */
            color: #333;
        }

        .member-balance {
            background-color: #007bff;
            color: white;
            padding: 5px 8px;
            margin-top: 8px;
            border-radius: 5px;
            font-size: 0.85em; /* Smaller balance font */
            font-weight: bold;
            display: inline-block; /* Fit content width */
        }

        .prime-tag {
            position: absolute;
            top: 120px; /* Position slightly above bottom of image */
            right: 8px; /* Position from right */
            transform: translateY(-50%); /* Center vertically relative to its top */
            background-color: #ffc107; /* Gold color for prime */
            color: #333; /* Dark text */
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px; /* Very small font */
            font-weight: bold;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }


        /* --- Balance Modal --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001; /* Ensure it's above everything */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5); /* Darker overlay */
            backdrop-filter: blur(3px); /* Blur background */
            -webkit-backdrop-filter: blur(3px);
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
        }

        .modal-content {
            background-color: #fff; /* White modal */
            padding: 25px;
            border-radius: 10px;
            width: 90%; /* Responsive width */
            max-width: 350px; /* Max width */
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            position: relative; /* Needed for close button positioning */
            box-sizing: border-box;
        }

        .modal-content h2 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #007bff;
        }

        .close {
            position: absolute; /* Position relative to modal-content */
            top: 10px;
            right: 15px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1; /* Adjust line height */
        }

        .close:hover,
        .close:focus {
            color: #333; /* Darker on hover */
            text-decoration: none;
        }

        .balance-display {
            font-size: 2.5em; /* Larger balance display */
            font-weight: bold;
            margin: 20px 0;
            color: #28a745; /* Green color for balance */
            display: block; /* Full width */
        }


        /* --- Footer --- */
        footer {
            background-color: #007bff;
            color: white;
            padding: 15px 0;
            margin-top: 30px;
            font-size: 0.9em;
        }

       /* --- Civil Button --- */
        #civilButton {
            background: linear-gradient(140.14deg, #ec540e 15.05%, #d6361f 114.99%) padding-box,
                        linear-gradient(142.51deg, #ff9465 8.65%, #af1905 88.82%) border-box;
            border-radius: 7px;
            border: 2px solid transparent;
            text-shadow: 1px 1px 1px #00000040;
            box-shadow: 0 4px 10px 0px #45090059; /* Softer shadow */
            padding: 10px 30px; /* Adjusted padding */
            line-height: 20px;
            cursor: pointer;
            transition: all 0.3s ease; /* Smoother transition */
            color: white;
            font-size: 1em; /* Relative font size */
            font-weight: 500;
            width: auto;
            display: inline-block;
            margin-top: 15px; /* Add space above */
            margin-bottom: 10px; /* Add space below */
        }

        #civilButton:hover {
            box-shadow: none;
            opacity: 0.9; /* Slightly less opaque */
        }


        /* --- Responsive Adjustments --- */

        /* Medium screens (Tablets) */
        @media (min-width: 600px) {
            .feature {
                width: calc(33.33% - 20px); /* Three columns */
            }
             .member-card {
                flex: 0 0 calc(30% - 10px); /* ~3 cards visible */
                max-width: 180px;
            }
             h1 { font-size: 2em; }
        }

        /* Larger screens (Desktops) */
        @media (min-width: 992px) {
            .feature {
                width: calc(25% - 20px); /* Four columns */
            }
            .member-card {
                flex: 0 0 calc(20% - 10px); /* ~5 cards visible */
                max-width: 200px;
            }
            .circle-container {
                width: 300px;
                height: 300px;
            }
            .circle-container .button {
                width: 120px; height: 120px; font-size: 16px;
            }
            .circle-container .button img {
                width: 40px; height: 40px; margin-bottom: 8px;
            }
        }

        /* Smaller screens (Small Mobiles) */
        @media (max-width: 400px) {
             h1 { font-size: 1.5em; }
            .circle-container { width: 240px; height: 240px; }
            .circle-container .button { width: 80px; height: 80px; font-size: 10px;}
            .circle-container .button img { width: 25px; height: 25px;}
             .member-card {
                 flex: 0 0 calc(50% - 10px); /* Ensure 2 cards fit */
                 max-width: 150px;
             }
             .loan-calculator input, .loan-calculator select, .feedback-form input, .feedback-form textarea {
                 padding: 10px; font-size: 0.9em;
             }
             .general-button, .loan-calculator button, .feedback-form button {
                 padding: 10px 20px; font-size: 0.9em;
             }
             .balance-display { font-size: 2em; }
        }

    </style>
</head>
<body>
<header>
    <div class="slider">
        <img id="sliderImage" src="https://i.imgur.com/jy7gXWz.png" alt="Community Loan Banner">
    </div>

    <h1 style="color: white; font-size: 25px; text-align: center; font-family: Arial, sans-serif; margin: 20px 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
        Bank Community Loan
    </h1>

    <h4 style="color: white; text-align: center; margin-top: 0;">ESTD: 23 जून 2024</h4>

    <div style="text-align: center;">
        <a href="https://bank-community.github.io/Loan-from/members.html">
            <button id="civilButton">ALL MEMBERS</button>
        </a>
    </div>
</header>

<div class="bank-members">
    <div class="header-container">
        <h2 class="bank-headline">BANK MEMBERS</h2>
        <div class="view-balance" id="viewBalanceBtn">
            <img src="https://i.imgur.com/TEHsZ32.png" alt="View Balance" class="balance-icon">
            <span>View Balance</span>
        </div>
    </div>
    <div class="member-slider" id="memberContainer">
        <p style="color: #555; text-align: center; width: 100%;">Loading members...</p>
    </div>
</div>

<div id="balanceModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>Available Community Balance</h2>
        <div id="totalBalance" class="balance-display">₹0</div>
    </div>
</div>


    <p>हमारी कम्युनिटी में लोग आपस में मिलकर <strong>Bank Community Loan</strong> में फंड इकट्ठा करते हैं। सभी सदस्य थोड़ी-थोड़ी राशि जमा करते हैं, जिसकी शुरुआत सिर्फ <strong>₹500/-</strong> से होती है।</p>

    <h2>💡 कैसे काम करता है?</h2>
    <div class="features">
        <div class="feature">
            <h3>फंड जमा</h3>
            <p>सभी सदस्य मिलकर फंड जमा करते हैं (SIP और Payment).</p>
        </div>
        <div class="feature">
            <h3>लोन प्रदान</h3>
            <p>जरूरतमंद सदस्य को उसी फंड से <strong>लोन</strong> दिया जाता है।</p>
        </div>
        <div class="feature">
            <h3>लोन अवधि</h3>
            <p>लोन केवल <strong>1 महीने</strong> के लिए होता है (न्यूनतम ब्याज पर)।</p>
        </div>
        <div class="feature">
            <h3>ब्याज दर</h3>
            <p>अवधि और राशि के अनुसार ब्याज दरें बदल सकती हैं।</p>
        </div>
    </div>

    <h2>👑 Prime Members</h2>
    <p style="line-height: 1.6;">👉 Amit kumar<br>👉 Mithlesh sahani<br>👉 Prince rama</p>

    <h2>📝 पारदर्शिता और सूचना</h2>
    <p>हमारी पूरी प्रक्रिया पारदर्शी है। आपके सभी डिटेल्स और लेन-देन की जानकारी सुरक्षित रहती है और सदस्यों को उपलब्ध कराई जाती है।</p>

    <div class="circle-container">
        <button class="button top" onclick="window.open('https://bank-community.github.io/Loan-from/members.html')">
            <img src="https://cdn-icons-png.flaticon.com/128/9942/9942543.png" alt="Member">Members
        </button>
        <button class="button right whatsapp-button" onclick="window.open('https://chat.whatsapp.com/G39I0hP55WIDHMu5YkAjDZ', '_blank')">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp"> WhatsApp
        </button>
        <button class="button bottom" onclick="window.open('https://bank-community.github.io/Loan-from/loan.html')">
            <img src="https://cdn-icons-png.flaticon.com/128/9196/9196974.png" alt="Helping"> Loan Form
        </button>
        <button class="button left" onclick="window.open('https://codepen.io/Vk-T/full/azbEeba')">
            <img src="https://cdn-icons-png.flaticon.com/128/5836/5836188.png" alt="New Member">New Join
        </button>
    </div>

    <div class="loan-calculator">
        <h2>लोन कैलकुलेटर (उदाहरण)</h2>
        <input type="number" id="loanAmount" placeholder="लोन राशि (₹)">
        <select id="interestRate">
            <option value="1">1 महीने के लिए 1% ब्याज</option>
            <option value="3">2 महीने के लिए 3% ब्याज</option>
            <option value="5">3 महीने के लिए 5% ब्याज</option>
        </select>
        <button class="general-button" onclick="calculateLoan()">गणना करें</button>
        <p id="loanResult"></p>
    </div>

    <div class="feedback-form">
        <h2>फीडबैक दें</h2>
        <form action="https://formspree.io/f/xvgkokge" method="POST">
            <input type="text" name="name" placeholder="नाम" required>
            <input type="email" name="email" placeholder="ईमेल" required>
            <textarea name="message" placeholder="आपका संदेश..." required rows="4"></textarea>
            <button type="submit" class="general-button">Submit</button>
        </form>
    </div>

    <h2>About Community Letter</h2>
    <div class="slider-container">
        <div class="slides">
            <div class="slide"><img src="https://i.imgur.com/6x6AuuN.png" alt="Loan Letter"></div>
            <div class="slide"><img src="https://i.imgur.com/fUMEyY9.png" alt="Prime Letter"></div>
            <div class="slide"><img src="https://i.imgur.com/ZsvB26M.png" alt="Join Letter"></div>
        </div>
        <button class="prev" onclick="prevSlide()">&#10094;</button>
        <button class="next" onclick="nextSlide()">&#10095;</button>
    </div>
    <div class="slide-indicator">
        <span class="indicator-dot active" onclick="goToSlide(0)"></span>
        <span class="indicator-dot" onclick="goToSlide(1)"></span>
        <span class="indicator-dot" onclick="goToSlide(2)"></span>
    </div>

    <footer>
        <p>&copy; 2025 बैंक कम्युनिटी लोन. सभी अधिकार सुरक्षित.</p>
    </footer>

<script>
    // --- Header Image Slider ---
    const headerImages = [
        "https://i.imgur.com/pEWE3nL.png",
        "https://i.imgur.com/FsIMTye.png",
        "https://i.imgur.com/xtqkYZH.png"
    ];
    let currentHeaderImageIndex = 0;
    const sliderImageElement = document.getElementById("sliderImage");

    function changeHeaderImage() {
        currentHeaderImageIndex = (currentHeaderImageIndex + 1) % headerImages.length;
        if (sliderImageElement) {
           sliderImageElement.src = headerImages[currentHeaderImageIndex];
        }
    }
    if (headerImages.length > 1) {
      setInterval(changeHeaderImage, 3000); // Change image every 3 seconds only if more than one image
    }


    // --- Loan Calculator ---
    // Note: Removed the 2% toggle logic as it wasn't in the final code before update request
    function calculateLoan() {
        const loanAmountInput = document.getElementById('loanAmount');
        const interestRateSelect = document.getElementById('interestRate');
        const loanResultElement = document.getElementById('loanResult');

        const loanAmount = parseFloat(loanAmountInput.value);
        const interestRate = parseFloat(interestRateSelect.value);

        if (isNaN(loanAmount) || loanAmount <= 0) {
            loanResultElement.innerText = "कृपया मान्य लोन राशि दर्ज करें।";
            return;
        }
        if (isNaN(interestRate)) {
             loanResultElement.innerText = "कृपया मान्य ब्याज दर चुनें।";
             return;
        }

        const interest = (loanAmount * interestRate) / 100;
        const totalAmount = loanAmount + interest;
        loanResultElement.innerText = `कुल चुकौती राशि: ₹${totalAmount.toFixed(2)} (ब्याज: ₹${interest.toFixed(2)})`;
    }


    // --- About Letter Slider ---
    let currentSlideIndex = 0;
    const slidesContainer = document.querySelector('.slider-container .slides');
    const totalSlides = slidesContainer ? slidesContainer.children.length : 0;
    const indicatorDots = document.querySelectorAll('.indicator-dot');

    function showSlide(index) {
        if (!slidesContainer || totalSlides === 0) return; // Exit if no slider elements
        if (index >= totalSlides) index = 0;
        if (index < 0) index = totalSlides - 1;
        currentSlideIndex = index;
        slidesContainer.style.transform = `translateX(${-currentSlideIndex * 100}%)`;
        updateDots();
    }

    function prevSlide() { showSlide(currentSlideIndex - 1); }
    function nextSlide() { showSlide(currentSlideIndex + 1); }
    function goToSlide(index) { showSlide(index); }

    function updateDots() {
        indicatorDots.forEach((dot, index) => {
             if(dot) { // Check if dot exists
               dot.classList.toggle('active', index === currentSlideIndex);
             }
        });
    }
    // Initialize slider
    if (totalSlides > 0) {
        showSlide(0);
    }

    // --- Bank Members Data Handling ---
    const API_URL = 'https://script.google.com/macros/s/AKfycbz9LCkPR8L3-i7F1KG2KUJ6It2l_p55murljRJ_4108nFysOXUOpG5WEs1sdEaGHq1L7w/exec';
    const DEFAULT_IMAGE = 'https://i.imgur.com/6aATcZR.jpeg'; // Default image if none provided

    // Function to fetch data from API
    async function fetchMemberData() {
        const container = document.getElementById('memberContainer');
        try {
            const response = await fetch(API_URL);
            if (!response.ok) {
                 throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            // Filter out entries without a name
            const validData = data.filter(entry => entry.Name && entry.Name.trim() !== "");
            processMemberData(validData);
        } catch (error) {
            console.error('Error fetching member data:', error);
            if (container) {
               container.innerHTML = '<p style="color: red; text-align: center; width: 100%;">सदस्य डेटा लोड करने में विफल।</p>';
            }
        }
    }

    // Process and aggregate data for each member
    function processMemberData(data) {
        const members = {};

        data.forEach(entry => {
            const name = entry.Name.trim();
            // Safely parse numbers, default to 0 if invalid or empty
            const loanAmount = parseFloat(entry.Loan) || 0;
            const paymentAmount = parseFloat(entry.Payment) || 0;
            const sipAmount = parseFloat(entry["SIP Payment"]) || 0; // Use bracket notation
            const imageUrl = entry.imageUrl && entry.imageUrl.trim() !== "" ? entry.imageUrl.trim() : null;

            if (!members[name]) {
                // Initialize member if not exists
                members[name] = {
                    name: name,
                    totalLoan: 0,
                    totalPayment: 0,
                    totalSIP: 0,
                    imageUrl: null // Start with no image
                };
            }

            // Aggregate amounts
            members[name].totalLoan += loanAmount;
            members[name].totalPayment += paymentAmount;
            members[name].totalSIP += sipAmount;

            // Update image URL - Take the last non-empty one found for this member
            if (imageUrl) {
                members[name].imageUrl = imageUrl;
            }
        });

        // Calculate final balance and prepare list
        const memberList = Object.values(members).map(member => {
            const balance = (member.totalSIP + member.totalPayment) - member.totalLoan;
            return {
                ...member,
                balance: balance,
                // Use default image if no valid URL was found
                displayImageUrl: member.imageUrl || DEFAULT_IMAGE
            };
        });

        // Sort members by balance (highest first)
        memberList.sort((a, b) => b.balance - a.balance);

        // Display members
        displayMembers(memberList);

        // Update total balance for the modal after processing
        updateTotalBalanceDisplay(memberList);
    }

    // Display members in cards
    function displayMembers(members) {
        const container = document.getElementById('memberContainer');
        if (!container) return; // Exit if container not found
        container.innerHTML = ''; // Clear previous content or loading message

        if (members.length === 0) {
             container.innerHTML = '<p style="color: #555; text-align: center; width: 100%;">कोई सदस्य डेटा उपलब्ध नहीं है।</p>';
             return;
        }

        const primeMemberNames = ["Prince rama", "Amit kumar", "Mithlesh sahni"]; // List of prime members

        members.forEach(member => {
            const card = document.createElement('div');
            card.className = 'member-card';

            const isPrime = primeMemberNames.includes(member.name);
            const primeTagHTML = isPrime ? '<div class="prime-tag">Prime</div>' : ''; // Simplified Prime Tag

            card.innerHTML = `
                ${primeTagHTML}
                <img src="${member.displayImageUrl}" alt="${member.name}" onerror="this.src='${DEFAULT_IMAGE}'"> <p class="member-name">${member.name}</p>
                <p class="member-balance">Balance: ₹${member.balance.toFixed(2)}</p>
            `;

            // Add click event to show full image (using displayImageUrl)
            card.onclick = () => showFullImage(member.displayImageUrl, member.name);

            container.appendChild(card);
        });
    }

    // Show full image in a modal overlay
   function showFullImage(imageUrl, memberName) {
        // Remove existing modal first if any
        const existingModal = document.getElementById('imageModal');
        if(existingModal) {
            document.body.removeChild(existingModal);
        }

        const modal = document.createElement('div');
        modal.id = 'imageModal'; // Add an ID for potential removal
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.backgroundColor = 'rgba(0,0,0,0.9)'; // Darker background
        modal.style.display = 'flex';
        modal.style.flexDirection = 'column';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '1002'; // Ensure it's above other modals
        modal.style.cursor = 'pointer';
        modal.style.padding = '20px'; // Add padding
        modal.style.boxSizing = 'border-box';

        const img = document.createElement('img');
        img.src = imageUrl;
        img.style.maxWidth = '90%'; // Limit image width
        img.style.maxHeight = '80%'; // Limit image height
        img.style.objectFit = 'contain';
        img.style.display = 'block';
        img.style.border = '3px solid white'; // White border
        img.style.borderRadius = '5px';

        const name = document.createElement('p');
        name.textContent = memberName;
        name.style.color = 'white';
        name.style.marginTop = '15px';
        name.style.fontSize = '1.2rem';
        name.style.textAlign = 'center';

        modal.appendChild(img);
        modal.appendChild(name);

        // Close modal when clicked anywhere on it
        modal.onclick = () => document.body.removeChild(modal);

        document.body.appendChild(modal);
    }


    // --- Balance Modal Functionality ---
    const balanceModalElement = document.getElementById('balanceModal');
    const viewBalanceBtn = document.getElementById('viewBalanceBtn');
    const totalBalanceElement = document.getElementById('totalBalance');
    let netCommunityBalance = 0; // Store calculated balance

    // Function to update the total balance display (called by processMemberData)
    function updateTotalBalanceDisplay(memberList) {
        netCommunityBalance = memberList.reduce((sum, member) => sum + member.balance, 0);
        // We don't display it here, only calculate and store it
        // The display happens when the modal is opened
    }

    // Function to show the balance modal with animation
    function showBalanceModal() {
        if (!balanceModalElement || !totalBalanceElement) return;

        balanceModalElement.style.display = 'flex'; // Use flex to center content
        totalBalanceElement.textContent = '₹0'; // Start from zero

        // Animate the balance count-up
        let current = 0;
        const target = netCommunityBalance; // Use the stored balance
        const duration = 1000; // Animation duration in ms
        const stepTime = 20; // Update interval
        const steps = duration / stepTime;
        const increment = target / steps;

        const timer = setInterval(() => {
            current += increment;
            if ((increment > 0 && current >= target) || (increment < 0 && current <= target) || increment === 0) {
                clearInterval(timer);
                current = target; // Ensure final value is exact
            }
            // Format with commas for thousands separator
            totalBalanceElement.textContent = '₹' + Math.floor(current).toLocaleString('en-IN');
        }, stepTime);
    }

    // Function to close the modal
    function closeModal() {
         if (balanceModalElement) {
           balanceModalElement.style.display = 'none';
         }
    }

    // Event listener for the "View Balance" button
    if (viewBalanceBtn) {
      viewBalanceBtn.addEventListener('click', showBalanceModal);
    }

    // Event listener to close modal when clicking outside the content
    if (balanceModalElement) {
        window.addEventListener('click', function(event) {
            if (event.target == balanceModalElement) {
                closeModal();
            }
        });
    }
    // The close button itself uses onclick="closeModal()" in the HTML

    // --- Initial Data Load ---
    // Fetch member data when the page loads
    window.addEventListener('DOMContentLoaded', fetchMemberData);

</script>

</body>
</html>
