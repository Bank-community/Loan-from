<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡§¨‡•à‡§Ç‡§ï ‡§ö‡•à‡§ü‡§¨‡•â‡§ü</title>
    <style>
        /* --- Enhanced Styles --- */
:root {
    --primary-color: #45a049; /* Slightly softer green */
    --primary-darker: #3c8e40;
    --secondary-color: #f4f6f8; /* Lighter grey background */
    --user-message-bg: #e2ffc7; /* Lighter user message */
    --bot-message-bg: #ffffff; /* White */
    --text-dark: #212529;
    --text-light: #5a6a79;
    --border-color: #e0e0e0;
    --suggestion-bg: #e9f5e9;
    --suggestion-hover-bg: #d8eed8;
    --prime-member-bg: #ffc107; /* Yellow for Prime tag BG */
    --prime-member-text: #000000; /* Black for Prime tag text */
    --loan-highlight-color: #dc3545; /* Red for loan highlight */
    --header-height: 60px;
    --input-area-height: 60px;
    --border-radius: 10px; /* Slightly larger radius */
    --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    --message-shadow: 0 2px 5px rgba(0, 0, 0, 0.06);
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; font-family: 'Segoe UI', 'Roboto', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--secondary-color); overflow: hidden; font-size: 16px; }
.chat-container { display: flex; flex-direction: column; height: 100%; width: 100%; max-width: 800px; margin: 0 auto; background: var(--bot-message-bg); box-shadow: 0 6px 25px rgba(0, 0, 0, 0.1); border-radius: 0; }
@media (min-width: 801px) { .chat-container { height: 90vh; max-height: 750px; margin: 25px auto; border-radius: var(--border-radius); overflow: hidden; /* Clip content to rounded corners */ } }

.chat-header { height: var(--header-height); background: linear-gradient(135deg, var(--primary-color), var(--primary-darker)); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.3em; font-weight: 600; padding: 0 20px; flex-shrink: 0; border-top-left-radius: inherit; border-top-right-radius: inherit; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); }
.chat-header .icon { margin-right: 12px; font-size: 1.6em; }

.chat-messages { flex-grow: 1; padding: 20px 15px; overflow-y: auto; background-color: var(--secondary-color); display: flex; flex-direction: column; gap: 15px; }
/* Custom Scrollbar */
.chat-messages::-webkit-scrollbar { width: 6px; }
.chat-messages::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
.chat-messages::-webkit-scrollbar-thumb { background: #c5c5c5; border-radius: 3px; }
.chat-messages::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }

.message { padding: 14px 20px; border-radius: 18px; line-height: 1.65; word-wrap: break-word; max-width: 90%; position: relative; box-shadow: var(--message-shadow); font-size: 0.98em; }
.message a { color: #0066cc; text-decoration: underline; } .message a:hover { color: #004c99; }
.message p { margin-bottom: 10px; } .message p:last-child { margin-bottom: 0; }
.message ul, .message ol { margin-left: 20px; margin-bottom: 10px; padding-left: 15px; } .message ul li { margin-bottom: 6px; }

/* User & Bot Bubble Styles */
.user { align-self: flex-end; background-color: var(--user-message-bg); color: var(--text-dark); border-bottom-right-radius: 6px; }
.bot { align-self: flex-start; background-color: var(--bot-message-bg); color: var(--text-dark); border: 1px solid var(--border-color); border-bottom-left-radius: 6px; }
.bot.typing { color: var(--text-light); font-style: italic; background-color: transparent; border: none; box-shadow: none; padding-left: 0; }

/* --- ‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§°‡•á‡§ü‡•á‡§° CSS --- */

.user-details-card {
    padding: 20px;                 /* ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§™‡•à‡§°‡§ø‡§Ç‡§ó */
    border: 1px solid var(--border-color); /* ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ */
    border-radius: var(--border-radius);   /* ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§∞‡•á‡§°‡§ø‡§Ø‡§∏ */
    background-color: #ffffff;     /* ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§™‡•É‡§∑‡•ç‡§†‡§≠‡•Ç‡§Æ‡§ø */
    margin-top: 8px;               /* ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ú‡§ø‡§® */
    box-shadow: var(--card-shadow);/* ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§∂‡•à‡§°‡•ã */
    width: 110%;                   /* <<<--- ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ï‡•Ä ‡§™‡•Ç‡§∞‡•Ä ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§≤‡•á‡§®‡•á ‡§¶‡•á‡§Ç */
    max-width: 650px;              /* <<<--- ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç (‡§∏‡§Æ‡§æ‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç) */
    box-sizing: border-box;        /* <<<--- ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§™‡•à‡§°‡§ø‡§Ç‡§ó ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à */
    /* ‡§Ø‡§¶‡§ø ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•ã ‡§§‡•ã ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§™‡•á‡§ï‡•ç‡§∑ ‡§Æ‡§æ‡§∞‡•ç‡§ú‡§ø‡§® ‡§∏‡§Æ‡§æ‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç */
    margin-left: auto;
    margin-right: auto;
}

/* ‡§¨‡§æ‡§ï‡•Ä ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡•ç‡§∏ (‡§á‡§®‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§¨‡§¶‡§≤‡§æ‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§ï‡§æ‡§∞‡•ç‡§° ‡§≤‡•á‡§Ü‡§â‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡§Ç) */
.user-details-header {
    display: flex;
    align-items: center;
    gap: 18px;
    margin-bottom: 18px;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
}

.profile-pic-container {
    position: relative;
    flex-shrink: 0;
    width: 80px;
    height: 80px;
}

.profile-pic {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 10%;
    cursor: pointer;
    border: 3px solid #fff;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    background-color: #eee;
}

.prime-tag-on-photo {
    position: absolute;
    top: -6px;
    right: -6px;
    background-color: var(--prime-member-bg);
    color: var(--prime-member-text);
    font-size: 0.75em;
    font-weight: bold;
    padding: 4px 8px;
    border-radius: 6px;
    line-height: 1;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    z-index: 1;
}

.user-info {
    flex-grow: 1; /* ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§∂‡•á‡§∑ ‡§∏‡•ç‡§•‡§æ‡§® ‡§≤‡•á‡§®‡•á ‡§¶‡•á‡§Ç */
}

.user-info h3 {
    margin: 0;
    font-size: 1.3em;
    color: var(--text-dark);
    font-weight: 600;
}

.user-info p {
    margin: 5px 0 0;
    font-size: 0.9em;
    color: var(--text-light);
}
.user-info .label {
    font-weight: 500;
}

.user-stats {
    padding-top: 15px;
}

.user-stats p {
    margin-bottom: 12px;
    font-size: 0.98em;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap; /* ‡§∏‡§Ç‡§ï‡•Ä‡§∞‡•ç‡§£ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§™‡§∞ ‡§∞‡•à‡§™‡§ø‡§Ç‡§ó ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç */
    gap: 5px 10px;   /* ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§ó‡•à‡§™, ‡§ï‡•â‡§≤‡§Æ ‡§ó‡•à‡§™ */
    padding-bottom: 8px; /* ‡§™‡•à‡§°‡§ø‡§Ç‡§ó ‡§•‡•ã‡§°‡§º‡•Ä ‡§¨‡§¢‡§º‡§æ ‡§¶‡•Ä */
    border-bottom: 1px dashed #eee;
}
.user-stats p:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

.user-stats .label {
    color: var(--text-light);
    margin-right: 8px;
    display: flex;
    align-items: center;
    gap: 6px; /* ‡§Ü‡§á‡§ï‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§•‡•ã‡§°‡§º‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§ó‡•à‡§™ */
    flex-shrink: 0; /* ‡§≤‡•á‡§¨‡§≤ ‡§ï‡•ã ‡§¨‡§π‡•Å‡§§ ‡§∏‡§ø‡§ï‡•Å‡§°‡§º‡§®‡•á ‡§∏‡•á ‡§∞‡•ã‡§ï‡•á‡§Ç */
}

.user-stats .value {
    font-weight: 600;
    text-align: right;
    flex-grow: 1;        /* ‡§Æ‡§æ‡§® ‡§ï‡•ã ‡§∂‡•á‡§∑ ‡§∏‡•ç‡§•‡§æ‡§® ‡§≤‡•á‡§®‡•á ‡§¶‡•á‡§Ç */
    word-break: break-word; /* ‡§≤‡§Ç‡§¨‡•á ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§π‡•ã‡§®‡•á ‡§∏‡•á ‡§∞‡•ã‡§ï‡•á‡§Ç */
}

.user-stats .label .icon {
    font-size: 1.1em;
    opacity: 0.7;
}

.loan-highlight {
    color: var(--loan-highlight-color);
    font-weight: 700;
}

.sip-status {
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 5px;
    font-size: 0.9em;
    display: inline-block;
}
.sip-status.paid { color: #fff; background-color: #28a745; }
.sip-status.pending { color: #fff; background-color: var(--loan-highlight-color); }
.sip-status.due { color: #333; background-color: #ffc107; }


/* Clickable Member List */
.member-list-container { padding: 10px 0; max-height: 220px; overflow-y: auto; }
.clickable-member { display: block; padding: 10px 15px; margin-bottom: 5px; background-color: #f8f9fa; border-radius: 6px; cursor: pointer; color: var(--text-dark); text-decoration: none; transition: background-color 0.2s ease, color 0.2s ease; font-size: 0.98em; border: 1px solid var(--border-color); }
.clickable-member:hover { background-color: var(--primary-color); color: white; border-color: var(--primary-darker); }

/* Suggestions IN CHAT */
.suggestion-group { background-color: var(--bot-message-bg); border: 1px solid var(--border-color); padding: 18px; margin-top: 8px; border-radius: 15px; align-self: flex-start; max-width: 85%; box-shadow: var(--message-shadow); }
.suggestion-group .group-title { font-weight: 600; margin-bottom: 14px; color: var(--text-light); font-size: 0.9em; }
.chat-suggestion { display: block; background-color: var(--suggestion-bg); color: var(--primary-color); padding: 11px 16px; border-radius: 8px; cursor: pointer; font-size: 0.92em; margin-bottom: 8px; border: 1px solid #d0e0d0; transition: background-color 0.2s ease, border-color 0.2s ease, transform 0.1s ease; text-align: left; font-weight: 500; }
.chat-suggestion:hover { background-color: var(--suggestion-hover-bg); border-color: #b0c0b0; transform: translateY(-1px); }
.chat-suggestion:last-child { margin-bottom: 0; }

/* --- Input Area --- */
.chat-input-area { height: var(--input-area-height); display: flex; align-items: center; border-top: 1px solid var(--border-color); background-color: #ffffff; padding: 10px 12px; flex-shrink: 0; position: relative; border-bottom-left-radius: inherit; border-bottom-right-radius: inherit;}
.chat-input-area input { flex-grow: 1; height: 100%; padding: 0 18px; border: 1px solid var(--border-color); border-radius: 20px; font-size: 1em; outline: none; margin-right: 10px; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
.chat-input-area input:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(69, 160, 73, 0.2); }
.chat-input-area button { height: 100%; padding: 0 22px; border: none; background: var(--primary-color); color: white; cursor: pointer; font-size: 1em; font-weight: 600; border-radius: 20px; transition: background-color 0.2s ease; flex-shrink: 0; }
.chat-input-area button:hover { background: var(--primary-darker); }

/* Suggestions ABOVE input */
.suggestions { position: absolute; bottom: calc(var(--input-area-height) + 8px); left: 12px; right: 12px; display: flex; flex-direction: column; gap: 6px; padding: 12px; background: #ffffff; border: 1px solid var(--border-color); max-height: 220px; overflow-y: auto; z-index: 100; box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1); border-radius: 8px; }
.suggestion { background: #f1f1f1; color: var(--text-dark); padding: 10px 14px; border-radius: 6px; cursor: pointer; font-size: 0.9em; text-align: left; border: 1px solid transparent; transition: background-color 0.2s ease; }
.suggestion:hover { background: #e0e0e0; }

/* Image Modal Styles */
.modal-overlay { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.88); justify-content: center; align-items: center; }
.modal-content { margin: auto; display: block; max-width: 90%; max-height: 90%; border-radius: 5px; }
.modal-close { position: absolute; top: 25px; right: 40px; color: #f1f1f1; font-size: 45px; font-weight: bold; transition: 0.3s; cursor: pointer; line-height: 1; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
.modal-close:hover, .modal-close:focus { color: #bbb; text-decoration: none; }
    </style>
</head>
<body>

<div class="chat-container">
    <div class="chat-header">
        <span class="icon">üè¶</span>‡§¨‡•à‡§Ç‡§ï ‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§ö‡•à‡§ü‡§¨‡•â‡§ü üí¨
    </div>
    <div class="chat-messages" id="chat">
        <div class="message bot">
            ‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§¨‡•à‡§Ç‡§ï ‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§≤‡•ã‡§® ‡§Ø‡•ã‡§ú‡§®‡§æ, ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£, ‡§™‡§æ‡§§‡•ç‡§∞‡§§‡§æ, ‡§®‡§ø‡§Ø‡§Æ‡•ã‡§Ç ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å‡•§ ‡§Ü‡§™ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á ‡§∏‡§µ‡§æ‡§≤ ‡§™‡•Ç‡§õ‡•á‡§Ç, ‡§Æ‡•à‡§Ç ‡§∏‡§Æ‡§ù‡§®‡•á ‡§î‡§∞ ‡§∏‡§π‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§¶‡•á‡§®‡•á ‡§ï‡•Ä ‡§™‡•Ç‡§∞‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•Ç‡§Å‡§ó‡§æ‡•§
        </div>
        <div class="message bot suggestion-group">
             <div class="group-title">‡§Ü‡§™ ‡§á‡§∏ ‡§§‡§∞‡§π ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:</div>
             <div class="chat-suggestion" onclick="inputBox.value='‡§Æ‡•á‡§∞‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§ï‡§ø‡§§‡§®‡§æ ‡§π‡•à?'; send();">‡§Æ‡•á‡§∞‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§ï‡§ø‡§§‡§®‡§æ ‡§π‡•à?</div>
             <div class="chat-suggestion" onclick="inputBox.value='SIP ‡§≠‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§ñ‡§ø‡§∞‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?'; send();">SIP ‡§≠‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§ñ‡§ø‡§∞‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?</div>
             <div class="chat-suggestion" onclick="inputBox.value='Mithlesh Sahni ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡§ø‡§ñ‡§æ‡§ì'; send();">Mithlesh Sahni ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡§ø‡§ñ‡§æ‡§ì</div>
             <div class="chat-suggestion" onclick="inputBox.value='‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì'; send();">‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì</div>
        </div>
    </div>
    <div class="suggestions" id="suggestions" style="display:none;"></div>
    <div class="chat-input-area">
        <input id="input" type="text" placeholder="‡§Ö‡§™‡§®‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç..." oninput="showSuggestions(this.value)" onkeyup="handleKey(event)" autocomplete="off">
        <button onclick="send()" aria-label="‡§≠‡•á‡§ú‡•á‡§Ç">‡§≠‡•á‡§ú‡•á‡§Ç</button>
    </div>
</div>

<div id="imageModal" class="modal-overlay">
    <span class="modal-close" onclick="closeImageModal()">&times;</span>
    <img class="modal-content" id="modalImageContent">
</div>

<script>
// --- Configuration, Global State, dataSegments ---
const API_KEY = "AIzaSyBwhJNl7Rw4Xwb8esmsIes5uVX2fWlRnSE"; // <<<--- *** ‡§Ö‡§™‡§®‡•Ä Gemini API ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç ***
const SHEET_API_URL = "https://script.google.com/macros/s/AKfycbz9LCkPR8L3-i7F1KG2KUJ6It2l_p55murljRJ_4108nFysOXUOpG5WEs1sdEaGHq1L7w/exec"; // <<<--- *** ‡§Ö‡§™‡§®‡§æ Apps Script URL ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç ***
const defaultProfilePic = 'https://via.placeholder.com/100/CCCCCC/FFFFFF?text=üë§';
// Corrected name: Mithlesh Sahni
const primeMembers = ["Amit Kumar", "Mithlesh Sahni", "Prince Rama"]; // ‡§Ø‡§¶‡§ø ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•ã ‡§§‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç

let cachedSheetData = null;
let communityBalance = 0;
let isFetchingData = false;

// Rules/FAQ Data Store (dataSegments)
const dataSegments = [
  // ... (‡§∏‡§æ‡§∞‡§æ dataSegments ‡§µ‡§æ‡§≤‡§æ JSON ‡§Ø‡§π‡§æ‡§Å ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ) ...
  // Example:
  {
    "question": "Bank community loan kya hai?",
    "answer": "‡§¨‡•à‡§Ç‡§ï ‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§≤‡•ã‡§® ‡§è‡§ï ‡§Ü‡§™‡§∏‡•Ä ‡§∏‡§π‡§Ø‡•ã‡§ó ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§¨‡§ö‡§§ ‡§î‡§∞ ‡§ã‡§£ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§π‡•à, ‡§ú‡•ã ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§ï‡•á ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ú‡§∞‡•Ç‡§∞‡§§ ‡§™‡•ú‡§®‡•á ‡§™‡§∞ ‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "Scheme kaise work karti hai?",
    "answer": "‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡§∞ ‡§Æ‡§π‡•Ä‡§®‡•á ‡§è‡§ï ‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§∞‡§æ‡§∂‡§ø (‚Çπ500) SIP ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§ú‡§¨ ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•ã ‡§™‡•à‡§∏‡•á ‡§ï‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§µ‡§π ‡§Ö‡§™‡§®‡•Ä ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§≤‡•ã‡§® ‡§≤‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§Æ‡§Ç‡§ú‡•Ç‡§∞‡•Ä ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§ï‡•á ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Æ‡§ø‡§≤‡§ï‡§∞ ‡§≤‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§"
  },
  {
    "question": "Monthly SIP amount aur deadline kya hai?",
    "answer": "‡§π‡§∞ ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä 1 ‡§∏‡•á 10 ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‚Çπ500 SIP ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§®‡§æ ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à‡•§"
  },
  {
    "question": "SIP bounce hone par kya hota hai?",
    "answer": "‡§Ø‡§¶‡§ø ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•Ä SIP ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ 2-3 ‡§¨‡§æ‡§∞ ‡§¨‡§æ‡§â‡§Ç‡§∏ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§â‡§∏‡§ï‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ 1 ‡§µ‡§∞‡•ç‡§∑ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "Cancellation par deposit refund hoga?",
    "answer": "‡§π‡§æ‡§Å, ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§∞‡§¶‡•ç‡§¶ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•Å‡§≤ ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§≤‡•å‡§ü‡§æ‡§à ‡§ú‡§æ‡§è‡§ó‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§â‡§∏ ‡§™‡§∞ ‡§ï‡•ã‡§à ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ‡•§"
  },
  {
    "question": "Loan lene ke liye requirements kya hain?",
    "answer": "‡§≤‡•ã‡§® ‡§≤‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã ‡§™‡§π‡§≤‡•á ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ï‡§ø ‡§Ü‡§™‡§ï‡§æ ‡§ï‡•ã‡§à ‡§™‡§ø‡§õ‡§≤‡§æ ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§≤‡•ã‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§ ‡§≤‡•ã‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ï‡§æ ‡§≤‡§ø‡§Ç‡§ï ‡§π‡•à: https://bank-community.github.io/Loan-from/loan.html"
  },
   {
    "question": "Loan form link",
    "answer": "‡§Ü‡§™ ‡§≤‡•ã‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§á‡§∏ ‡§≤‡§ø‡§Ç‡§ï ‡§∏‡•á ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: https://bank-community.github.io/Loan-from/loan.html"
  },
  {
    "question": "Loan installment duration kya hai?",
    "answer": "‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§ï‡§ø‡§∏‡•ç‡§§ ‡§ï‡•Ä ‡§Ö‡§µ‡§ß‡§ø 31 ‡§¶‡§ø‡§® ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§Ö‡§ó‡§≤‡•Ä ‡§ï‡§ø‡§∏‡•ç‡§§ ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§°‡§º ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§"
  },
  {
    "question": "Free loan kya hai?",
    "answer": "‡§´‡•ç‡§∞‡•Ä ‡§≤‡•ã‡§® ‡§è‡§ï ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡•á ‡§§‡§π‡§§ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§¨‡§æ‡§∞ ‚Çπ1000 ‡§§‡§ï ‡§ï‡§æ ‡§≤‡•ã‡§® ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ 5 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§ø‡§®‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§ï‡•á ‡§≤‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ 5 ‡§¶‡§ø‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‚Çπ10 ‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§ø‡§® ‡§ï‡§æ ‡§≤‡•á‡§ü ‡§´‡§æ‡§á‡§® ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡•§"
  },
  {
    "question": "Maximum loan kitna le sakte hain?",
    "answer": "‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡•Å‡§≤ ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§ï‡§æ 1.5 ‡§ó‡•Å‡§®‡§æ ‡§§‡§ï ‡§≤‡•ã‡§® ‡§≤‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•ã ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§ï‡§æ ‡§¶‡•ã‡§ó‡•Å‡§®‡§æ ‡§≤‡•ã‡§® ‡§ö‡§æ‡§π‡§ø‡§è, ‡§§‡•ã ‡§Ü‡§™‡§ï‡•ã 2% ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§¶‡•á‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§"
  },
  {
    "question": "Loan par late fine rules kya hain?",
    "answer": "‡§Ø‡§¶‡§ø ‡§≤‡•ã‡§® 31 ‡§¶‡§ø‡§® ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§∞‡§π‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§â‡§∏ ‡§™‡§∞ ‡§¨‡•ç‡§Ø‡§æ‡§ú/‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä ‡§Ö‡§ó‡§≤‡•á ‡§Æ‡§π‡•Ä‡§®‡•á ‡§∏‡•á ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã‡§ó‡•Ä‡•§ 32-60 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è 3% ‡§î‡§∞ 61+ ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è 5% ‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä (RED MEMBER) ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "Late installment ka notification compulsory hai?",
    "answer": "‡§π‡§æ‡§Å, ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•Ä ‡§≤‡•ã‡§® ‡§ï‡§ø‡§∏‡•ç‡§§ ‡§¶‡•á‡§∞ ‡§∏‡•á ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™‡§ï‡•ã SMS ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à‡•§ ‡§ê‡§∏‡§æ ‡§® ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‚Çπ10 ‡§ï‡•Ä ‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä ‡§≤‡§ó ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "Installment bounce ka consequence kya hai?",
    "answer": "‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡§ø‡§∏‡•ç‡§§ ‡§¶‡•ã ‡§¨‡§æ‡§∞ ‡§¨‡§æ‡§â‡§Ç‡§∏ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§Ü‡§™ ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™‡§ï‡•ã 60 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ï‡•ã‡§à ‡§®‡§Ø‡§æ ‡§≤‡•ã‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤ ‡§™‡§æ‡§è‡§ó‡§æ‡•§"
  },
  {
    "question": "EMI loan ki conditions kya hain?",
    "answer": "EMI ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§™‡§∞ ‡§≤‡•ã‡§® ‡§≤‡•á‡§®‡•á ‡§™‡§∞ 8% ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡•§ ‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ‡§∞‡§æ‡§∂‡§ø ‚Çπ2500 ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è ‡§î‡§∞ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡•Ä ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§Ö‡§µ‡§ß‡§ø 3 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§π‡•ã‡§ó‡•Ä‡•§"
  },
  {
    "question": "New member join kaise karein?",
    "answer": "‡§®‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä 1 ‡§∏‡•á 5 ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‚Çπ500 ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§ ‡§®‡§è ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§®‡•á ‡§ï‡•á 60 ‡§¶‡§ø‡§® ‡§¨‡§æ‡§¶ ‡§π‡•Ä ‡§≤‡•ã‡§® ‡§≤‡•á‡§®‡•á ‡§ï‡•á ‡§™‡§æ‡§§‡•ç‡§∞ ‡§π‡•ã‡§Ç‡§ó‡•á‡•§"
  },
  {
    "question": "New member joining conditions kya hain?",
    "answer": "‡§®‡§è ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•ã ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø (‡§ó‡§æ‡§∞‡§Ç‡§ü‡§∞) ‡§ï‡•Ä ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä, 1 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§ó‡•ç‡§∞‡§ø‡§Æ SIP ‡§ú‡§Æ‡§æ ‡§î‡§∞ ‡§™‡•É‡§∑‡•ç‡§†‡§≠‡•Ç‡§Æ‡§ø ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à‡•§"
  },
  {
    "question": "Payment method aur QR code?",
    "answer": "‡§Ü‡§™ SIP ‡§Ø‡§æ ‡§≤‡•ã‡§® ‡§ï‡§æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§∏ QR ‡§ï‡•ã‡§° ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: https://i.ibb.co/0yLtTKTS/20250410-080021.png (‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç)‡•§"
  },
  {
    "question": "1 month loan par charge kitna hai?",
    "answer": "1 ‡§∏‡•á 31 ‡§¶‡§ø‡§® ‡§§‡§ï ‡§ï‡•á ‡§≤‡•ã‡§® ‡§™‡§∞ 1% ‡§ö‡§æ‡§∞‡•ç‡§ú ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡•§"
  },
  {
    "question": "2 month loan par penalty kitni hai?",
    "answer": "32 ‡§∏‡•á 60 ‡§¶‡§ø‡§® ‡§§‡§ï ‡§ï‡•á ‡§≤‡•ã‡§® ‡§™‡§∞ 3% ‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "3 month se zyada loan par penalty kitni hai?",
    "answer": "61 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§≤‡•ã‡§® ‡§∞‡§ñ‡§®‡•á ‡§™‡§∞ 5% ‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•ã 'RED MEMBER' ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ö‡§ø‡§π‡•ç‡§®‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§"
  },
   {
    "question": "Civil score kaise improve hota hai?",
    "answer": "‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‚Çπ100 ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§Ü‡§™‡§ï‡•á ‡§∏‡§ø‡§µ‡§ø‡§≤ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§Æ‡•á‡§Ç 10 ‡§™‡•â‡§á‡§Ç‡§ü‡•ç‡§∏ ‡§ú‡•Å‡§°‡§º‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§∏‡§ø‡§µ‡§ø‡§≤ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§≤‡•ã‡§® ‡§™‡§æ‡§§‡•ç‡§∞‡§§‡§æ ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§"
  },
  {
    "question": "Repayment ke baad re-loan rule kya hai?",
    "answer": "‡§®‡§π‡•Ä‡§Ç, ‡§ú‡§ø‡§∏ ‡§¶‡§ø‡§® ‡§Ü‡§™ ‡§≤‡•ã‡§® ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§â‡§∏ ‡§¶‡§ø‡§® ‡§Ü‡§™ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§≤‡•ã‡§® ‡§®‡§π‡•Ä‡§Ç ‡§≤‡•á ‡§∏‡§ï‡§§‡•á‡•§ ‡§Ü‡§™ ‡§Ö‡§ó‡§≤‡•á ‡§¶‡§ø‡§® ‡§∏‡•á ‡§™‡•Å‡§®‡§É ‡§≤‡•ã‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§"
  },
  {
    "question": "Member exit rules kya hain?",
    "answer": "‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡§®‡•á (Exit) ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 60 ‡§¶‡§ø‡§® ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è, ‡§ï‡•ã‡§à ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§≤‡•ã‡§® ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•ã Exit ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•Å‡§≤ ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§î‡§∞ ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§ ‡§¨‡•ç‡§Ø‡§æ‡§ú (‡§Ø‡§¶‡§ø ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã) ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä 1 ‡§∏‡•á 10 ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§≤‡•å‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§ 60 ‡§¶‡§ø‡§® ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§®‡§ø‡§ï‡§≤‡§®‡•á ‡§™‡§∞ 10% ‡§ï‡•Ä ‡§ï‡§ü‡•å‡§§‡•Ä ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "Prime members kaun hain?",
    "answer": `‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§™‡•ç‡§∞‡§æ‡§á‡§Æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ${primeMembers.join(', ')} ‡§π‡•à‡§Ç‡•§ ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§â‡§®‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§î‡§∞ ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§ö‡•Å‡§®‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§`
  },
   {
    "question": "Board members kaun hain?",
    "answer": `‡§¨‡•ã‡§∞‡•ç‡§° ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡•Ä ‡§™‡•ç‡§∞‡§æ‡§á‡§Æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡•à‡§Ç: ${primeMembers.join(', ')}‡•§`
  },
  {
    "question": "Prime member responsibilities kya hain?",
    "answer": "‡§â‡§®‡§ï‡•Ä ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä ‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§ó ‡§≤‡•á‡§®‡§æ, ‡§≤‡•ã‡§® ‡§µ‡§ø‡§§‡§∞‡§£ ‡§ï‡•Ä ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§ï‡§∞‡§®‡§æ, ‡§´‡§Ç‡§° ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡§∞ ‡§®‡§ú‡§∞ ‡§∞‡§ñ‡§®‡§æ, ‡§®‡§è ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§¶‡•á‡§®‡§æ ‡§î‡§∞ ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§Ü‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§"
  },
  {
    "question": "Prime member banne ke rules kya hain?",
    "answer": "‡§á‡§∏‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§æ ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§¶‡•á‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è, ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§≤‡•á‡§®‡•á ‡§Æ‡•á‡§Ç 70% ‡§∏‡§π‡§Æ‡§§‡§ø ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è ‡§î‡§∞ ‡§∏‡§ø‡§µ‡§ø‡§≤ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
  },
  {
    "question": "Guarantor requirements kya hain?",
    "answer": "‡§ó‡§æ‡§∞‡§Ç‡§ü‡§∞ ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•ã ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§∏‡§ø‡§µ‡§ø‡§≤ ‡§∏‡•ç‡§ï‡•ã‡§∞ 200 ‡§Ø‡§æ ‡§â‡§∏‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§è‡§ï ‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§î‡§∞ ‡§§‡§Ø ‡§∂‡§∞‡•ç‡§§‡•ã‡§Ç ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§"
  },
  {
    "question": "Meeting aur transparency details?",
    "answer": "‡§π‡§∞ ‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§ú‡§Æ‡§æ/‡§≤‡•ã‡§® ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°, ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§î‡§∞ ‡§ó‡§æ‡§∞‡§Ç‡§ü‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§î‡§∞ ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§™‡§∞ ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§‡§æ ‡§¨‡§®‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à‡•§"
  },
  {
    "question": "Bank community website link",
    "answer": "‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§π‡•à: https://bank-community.github.io/Loan-from"
  },
  {
    "question": "Scheme start date?",
    "answer": "‡§Ø‡§π ‡§Ø‡•ã‡§ú‡§®‡§æ 23 ‡§ú‡•Ç‡§® 2024 ‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡•Ä ‡§ó‡§à ‡§•‡•Ä‡•§"
  },
  {
    "question": "Concurrent loan rule kya hai?",
    "answer": "‡§π‡§æ‡§Å, ‡§Ø‡§¶‡§ø ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§®‡•á ‡§Ö‡§™‡§®‡•Ä ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§ï‡§æ 1.5 ‡§ó‡•Å‡§®‡§æ ‡§≤‡•ã‡§® ‡§≤‡•á ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§â‡§∏‡§ï‡•á ‡§ñ‡§æ‡§§‡•á ‡§Æ‡•á‡§Ç ‚Çπ1000 ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§ï‡•Ä ‡§∞‡§æ‡§∂‡§ø ‡§∂‡•á‡§∑ ‡§π‡•à, ‡§§‡•ã ‡§µ‡§π ‚Çπ1000 ‡§§‡§ï ‡§ï‡§æ ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§≤‡•ã‡§® ‡§≤‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§"
  },
  {
    "question": "Organisation kaise operate hoti hai?",
    "answer": "‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á WhatsApp ‡§ó‡•ç‡§∞‡•Å‡§™ ‡§î‡§∞ ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ WhatsApp ‡§ó‡•ç‡§∞‡•Å‡§™ ‡§≤‡§ø‡§Ç‡§ï: https://chat.whatsapp.com/G39I0hP55WIDHMu5YkAjDZ"
  },
  {
    "question": "Joining link",
    "answer": "‡§Ü‡§™ ‡§á‡§∏ ‡§≤‡§ø‡§Ç‡§ï ‡§™‡§∞ ‡§ú‡§æ‡§ï‡§∞ ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: https://bank-community.github.io/Loan-from/newbank.html"
  },
  {
      "question": "Total members count?",
      "answer": "‡§Ü‡§™ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç '‡§ï‡•Å‡§≤ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§ø‡§§‡§®‡•á ‡§π‡•à‡§Ç?' ‡§Ø‡§æ 'Total members?' ‡§î‡§∞ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¨‡§§‡§æ ‡§¶‡•Ç‡§Å‡§ó‡§æ‡•§"
  },
  {
      "question": "All members ke naam?",
      "answer": "‡§ï‡•É‡§™‡§Ø‡§æ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§™‡•Ç‡§õ‡•á‡§Ç '‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì' ‡§§‡§æ‡§ï‡§ø ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§™‡•Ç‡§∞‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡•á ‡§∏‡§ï‡•Ç‡§Å‡•§"
  },
  {
      "question": "Show all members list",
      "answer": "‡§ú‡§º‡§∞‡•Ç‡§∞, ‡§Ü‡§™ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§™‡•Ç‡§õ‡•á‡§Ç '‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì' ‡§î‡§∞ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§¶‡§ø‡§ñ‡§æ ‡§¶‡•Ç‡§Å‡§ó‡§æ, ‡§ú‡§ø‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§Ü‡§™ ‡§â‡§®‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§"
  },
   {
      "question": "Balance kaise check karein?",
      "answer": "‡§Ü‡§™ ‡§Ö‡§™‡§®‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§ú‡§æ‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç '[‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ] ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£'‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£: '‡§Ö‡§Æ‡§ø‡§§ ‡§ï‡•Å‡§Æ‡§æ‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£'‡•§"
  },
  {
      "question": "Loan eligibility kaise check karein?",
      "answer": "‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§≤‡•ã‡§® ‡§™‡§æ‡§§‡•ç‡§∞‡§§‡§æ ‡§ú‡§æ‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç '[‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ] ‡§ï‡•Ä ‡§≤‡•ã‡§® ‡§™‡§æ‡§§‡•ç‡§∞‡§§‡§æ'‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£: '‡§Ö‡§Æ‡§ø‡§§ ‡§ï‡•Å‡§Æ‡§æ‡§∞ ‡§ï‡•Ä ‡§≤‡•ã‡§® ‡§™‡§æ‡§§‡•ç‡§∞‡§§‡§æ'‡•§"
  },
   {
      "question": "Outstanding loan amount meaning?",
      "answer": "‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§≤‡•ã‡§® ‡§∞‡§æ‡§∂‡§ø ‡§µ‡§π ‡§∞‡§ï‡§Æ ‡§π‡•à ‡§ú‡•ã ‡§Ü‡§™‡§®‡•á ‡§ï‡•Å‡§≤ ‡§≤‡•ã‡§® ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à ‡§â‡§∏‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§Ü‡§™‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ï‡•Å‡§≤ *‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®* (SIP ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞) ‡§ï‡•ã ‡§ò‡§ü‡§æ‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§¨‡§ö‡§§‡•Ä ‡§π‡•à‡•§"
   },
   {
       "question": "Recent uncleared loan meaning?",
       "answer": "‡§Ø‡§¶‡§ø ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Æ‡•á‡§Ç '‡§π‡§æ‡§≤‡§ø‡§Ø‡§æ ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§≤‡•ã‡§®' ‡§¶‡§ø‡§ñ‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§®‡•á ‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§≤‡•ã‡§® ‡§≤‡§ø‡§Ø‡§æ ‡§•‡§æ ‡§î‡§∞ ‡§â‡§∏ ‡§≤‡•ã‡§® ‡§≤‡•á‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∏‡•á ‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à *‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®* (SIP ‡§®‡§π‡•Ä‡§Ç) ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§â‡§∏ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§≤‡•ã‡§® ‡§ï‡•Ä ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à‡•§"
   }
];


// --- DOM Elements ---
const chatBox = document.getElementById("chat");
const inputBox = document.getElementById("input");
const suggestionsBox = document.getElementById("suggestions");
const imageModal = document.getElementById("imageModal");
const modalImageContent = document.getElementById("modalImageContent");

// --- Utility Functions ---
// formatDate, calculateEligibility, getSipStatus, appendMessage, linkify,
// appendSuggestionGroup, displayFallbackSuggestions, typeEffect, openImageModal, closeImageModal
// (‡§Ø‡•á ‡§∏‡§≠‡•Ä ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§™‡§π‡§≤‡•á ‡§ú‡•à‡§∏‡•á ‡§π‡•Ä ‡§∞‡§π‡•á‡§Ç‡§ó‡•á)
 function formatDate(date, options = {}) {
        if (!(date instanceof Date) || isNaN(date)) return "--";
        const defaultOptions = { day: '2-digit', month: 'short', year: 'numeric' };
        const mergedOptions = { ...defaultOptions, ...options };
        try { return date.toLocaleDateString('en-GB', mergedOptions); }
        catch (e) {
            try { const y = date.getFullYear(), m = String(date.getMonth() + 1).padStart(2, '0'), d = String(date.getDate()).padStart(2, '0'); return `${y}-${m}-${d}`; }
            catch { return "--"; }
        }
    }
    function calculateEligibility(userName, userBalance, currentCommunityBalance) {
        if (!userName || userName === 'all') return { isEligible: false, approvedAmount: 0, reason: "‡§∏‡§≠‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§æ‡§ó‡•Ç ‡§®‡§π‡•Ä‡§Ç" };
         // Ensure community balance calculation is up-to-date if needed
        const latestCommunityBalance = cachedSheetData ? cachedSheetData.reduce((acc, r) => acc + r.Payment + r.SipPayment - r.Loan, 0) : 0;

        const isEligible = userBalance > 0 && latestCommunityBalance > 0;
        let approvedAmount = 0, reason = "";
        if (isEligible) {
            const potentialAmount = userBalance * 1.5; // Standard eligibility 1.5x
            approvedAmount = Math.floor(Math.min(potentialAmount, latestCommunityBalance)); // Cannot approve more than available balance
            reason = approvedAmount > 0 ? "" : "(‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§Æ‡•á‡§Ç ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§´‡§Ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à)";
        } else {
            if (userBalance <= 0) reason = `(‡§Ü‡§™‡§ï‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§Ø‡§æ ‡§ã‡§£‡§æ‡§§‡•ç‡§Æ‡§ï ‡§π‡•à: ‚Çπ${userBalance.toFixed(0)})`;
            else if (latestCommunityBalance <= 0) reason = "(‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§Æ‡•á‡§Ç ‡§´‡§Ç‡§° ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à)";
            else reason = "(‡§Ö‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡§æ‡§∞‡§£ ‡§∏‡•á ‡§Ö‡§™‡§æ‡§§‡•ç‡§∞)";
        }
        return { isEligible: isEligible && approvedAmount > 0, approvedAmount: approvedAmount, reason: reason };
    }
    function getSipStatus(userData) {
        if (!userData || userData.length === 0) return { statusText: "N/A", statusClass: "" };
        const now = new Date();
        const currentMonth = now.getMonth();
        const currentYear = now.getFullYear();
        const currentDay = now.getDate();

        // Find if a SIP payment exists for the current month and year
        const paidThisMonth = userData.some(r =>
            r.SipPayment > 0 &&
            r.Date instanceof Date &&
            !isNaN(r.Date) &&
            r.Date.getMonth() === currentMonth &&
            r.Date.getFullYear() === currentYear
        );

        if (paidThisMonth) {
            return { statusText: "‚úÖ Paid", statusClass: "paid" };
        } else if (currentDay > 10) { // Deadline is 10th
            return { statusText: "‚ùå Pending", statusClass: "pending" }; // Past due
        } else {
            return { statusText: "‚ö†Ô∏è Due", statusClass: "due" }; // Due within deadline
        }
    }
     function appendMessage(content, cls, isHtml = false) {
         const d = document.createElement("div"); d.className = "message " + cls;
         if (isHtml) {
              // Basic sanitation + ensure onclick safety
              const sanitizedContent = content.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
              d.innerHTML = sanitizedContent;
              // Add event listeners to dynamically added elements if needed, carefully
              // Example: If adding buttons with specific JS functions
              // d.querySelectorAll('.dynamic-button').forEach(button => {
              //     button.addEventListener('click', handleDynamicButtonClick);
              // });
         } else { d.textContent = content; }
         chatBox.appendChild(d);
         // Smooth scroll adjustment
         setTimeout(() => {
              chatBox.scrollTo({ top: chatBox.scrollHeight, behavior: 'smooth' });
         }, 50); // Small delay to allow element rendering
         return d;
     }
    function linkify(text) {
        // Regex to find URLs (http, https, ftp, file) and www. links
        const urlRegex = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])|(\bwww\.[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
        return text.replace(urlRegex, function(url) {
            let fullUrl = url;
            // Prepend http:// if protocol is missing (for www. links)
            if (!fullUrl.match(/^https?:\/\//i) && fullUrl.startsWith('www.')) {
                fullUrl = 'http://' + fullUrl;
            }
            // Escape potentially harmful characters in the displayed text
            const linkText = url.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            return `<a href="${fullUrl}" target="_blank" rel="noopener noreferrer">${linkText}</a>`;
        });
    }
     function appendSuggestionGroup(title, questions) {
         const groupDiv = document.createElement("div"); groupDiv.className = "message bot suggestion-group";
         const titleDiv = document.createElement("div"); titleDiv.className = "group-title"; titleDiv.textContent = title; groupDiv.appendChild(titleDiv);

         if (!Array.isArray(questions)) questions = [];

         // Shuffle and limit suggestions
         const shuffledQuestions = [...questions].sort(() => 0.5 - Math.random()).slice(0, 5); // Show up to 5

         shuffledQuestions.forEach(q_text => {
             if (!q_text || typeof q_text !== 'string') return; // Basic validation

             const suggestionEl = document.createElement("div");
             suggestionEl.className = "chat-suggestion";
             suggestionEl.textContent = q_text; // Use textContent for safety

             // Sanitize text before embedding in JS for onclick
             const sanitizedQText = q_text.replace(/'/g, "\\'").replace(/"/g, '\\"');
             suggestionEl.onclick = () => {
                 inputBox.value = q_text; // Set original text in input
                 suggestionsBox.style.display = 'none';
                 send();
             };
             groupDiv.appendChild(suggestionEl);
         });

         if (shuffledQuestions.length > 0) {
             chatBox.appendChild(groupDiv);
             // Scroll adjustment after adding suggestions
             setTimeout(() => {
                 chatBox.scrollTo({ top: chatBox.scrollHeight, behavior: 'smooth' });
             }, 100);
         }
     }
    function displayFallbackSuggestions(customTitle = "‡§Ü‡§™ ‡§Ø‡§π ‡§≠‡•Ä ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:") {
        const ruleQuestions = dataSegments.map(s => s.question);
        // Add common dynamic queries
        const commonQueries = ["‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì", "‡§ï‡•Å‡§≤ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§ø‡§§‡§®‡•á ‡§π‡•à‡§Ç?", "‡§Æ‡•á‡§∞‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§ï‡§ø‡§§‡§®‡§æ ‡§π‡•à?", "‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç ‡§≤‡•ã‡§® ‡§≤‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å?", "Loan lene ke liye requirements kya hain?"];
        let memberNames = [];
        if(cachedSheetData) {
            memberNames = [...new Set(cachedSheetData.map(r => r.Name))].slice(0, 3).map(name => `${name} ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£`);
        }

        const combinedSuggestions = [...new Set([...commonQueries, ...memberNames, ...ruleQuestions])]; // Combine and remove duplicates
        if (combinedSuggestions.length > 0) {
             // Display suggestions after a short delay
             setTimeout(() => { appendSuggestionGroup(customTitle, combinedSuggestions); }, 300);
        }
    }
    function typeEffect(text, targetElement, callback = null) {
        let i = 0;
        targetElement.innerHTML = '&nbsp;'; // Start with space for layout
        const interval = setInterval(() => {
            if (i < text.length) {
                // Append character by character
                targetElement.textContent = text.substring(0, i + 1);
                chatBox.scrollTop = chatBox.scrollHeight; // Keep scrolled down
                i++;
            } else {
                clearInterval(interval);
                // Apply linkify after text is fully typed
                const linkifiedHtml = linkify(targetElement.textContent); // Linkify the final text
                targetElement.innerHTML = linkifiedHtml;
                chatBox.scrollTo({ top: chatBox.scrollHeight, behavior: 'smooth' }); // Final scroll
                // Execute callback if provided
                if (typeof callback === 'function') {
                     setTimeout(callback, 200); // Delay callback slightly
                }
            }
        }, 25); // Typing speed (adjust as needed)
    }

    function openImageModal(imageUrl) {
        if (imageUrl && imageModal && modalImageContent) {
            if (imageUrl.includes('via.placeholder.com')) return; // Don't show modal for placeholder
            modalImageContent.src = imageUrl;
            imageModal.style.display = "flex"; // Use flex for centering
        }
    }
    function closeImageModal() {
        if (imageModal) {
            imageModal.style.display = "none";
            modalImageContent.src = ""; // Clear src
        }
    }


// --- Data Fetching & Processing ---
async function fetchAndProcessSheetData() {
    // This function remains the same as before
    if (isFetchingData) {
        console.log("Already fetching data, waiting...");
        // Simple wait mechanism
        await new Promise(resolve => setTimeout(resolve, 500));
        return cachedSheetData !== null;
    }
    if (cachedSheetData) return true; // Return if already cached

    isFetchingData = true;
    console.log("Fetching fresh sheet data...");
    const loadingMsg = appendMessage("‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...", "bot typing");

    try {
        const response = await fetch(SHEET_API_URL);
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status} ${response.statusText}`);
        }
        const rawData = await response.json();

        // Process data
        cachedSheetData = rawData.map(row => {
             let parsedDate = new Date(NaN);
             if (row.Date) {
                 parsedDate = new Date(row.Date);
                 if (isNaN(parsedDate)) {
                     const dateParts = String(row.Date).match(/^(\d{1,2})\s+([A-Za-z]+)\s+(\d{4})$/);
                     if (dateParts) {
                         parsedDate = new Date(`${dateParts[2]} ${dateParts[1]}, ${dateParts[3]}`);
                     }
                 }
             }
             if (isNaN(parsedDate)) { parsedDate = new Date(0); } // Use Epoch for invalid dates

             return {
                 Name: row.Name ? String(row.Name).trim() : 'Unknown',
                 Date: parsedDate,
                 Loan: parseFloat(row.Loan) || 0,
                 Payment: parseFloat(row.Payment) || 0,
                 SipPayment: parseFloat(row["SIP Payment"]) || 0,
                 ImageUrl: row.imageUrl || null
             };
        }).filter(r => r.Name !== 'Unknown' && r.Name.trim() !== ''); // Filter out empty/unknown names

        cachedSheetData.sort((a, b) => a.Date - b.Date); // Sort by date ascending

        // Calculate community balance
        communityBalance = cachedSheetData.reduce((acc, r) => acc + r.Payment + r.SipPayment - r.Loan, 0);

        console.log(`Sheet data processed. Members: ${new Set(cachedSheetData.map(r=>r.Name)).size}, Community Balance: ${communityBalance.toFixed(2)}`);
        loadingMsg?.remove();
        isFetchingData = false;
        return true;
    } catch (error) {
        console.error("Error fetching/processing sheet data:", error);
        cachedSheetData = null; // Reset cache on error
        communityBalance = 0;
        loadingMsg?.remove();
        isFetchingData = false;
        appendMessage(`‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤ ‡§∞‡§π‡§æ‡•§ (${error.message})`, "bot");
        return false;
    } finally {
        isFetchingData = false; // Ensure flag is reset
    }
}

function getUserDataAggregated(name) {
    // This function remains the same as before
     if (!cachedSheetData) {
         console.warn("Cannot get user data, cache is empty.");
         appendMessage("‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ ‡§Ö‡§≠‡•Ä ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§ï‡•ç‡§∑‡§£ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§", "bot"); // Inform user
         return null;
     }
     const lowerName = name.toLowerCase().trim();
     const canonicalNameEntry = cachedSheetData.find(r => r.Name.toLowerCase() === lowerName);

     if (!canonicalNameEntry) return null; // Name not found in data

     const canonicalName = canonicalNameEntry.Name;
     const userData = cachedSheetData.filter(r => r.Name === canonicalName);

     if (userData.length === 0) return null;

     let totalSIP = 0, totalLoan = 0, totalPayment = 0, latestImageUrl = "", joinDate = null;
     let lastLoanDate = null, latestLoanAmount = 0;

     const validDates = userData.map(r => r.Date).filter(d => d.getTime() !== 0);
     joinDate = validDates.length > 0 ? new Date(Math.min(...validDates)) : new Date(NaN);

     userData.forEach((record) => {
         totalSIP += record.SipPayment;
         totalLoan += record.Loan;
         totalPayment += record.Payment;
         if (record.ImageUrl) { latestImageUrl = record.ImageUrl; }

         if (record.Loan > 0 && record.Date instanceof Date && !isNaN(record.Date) && record.Date.getTime() !== 0) {
             if (!lastLoanDate || record.Date > lastLoanDate) {
                 lastLoanDate = record.Date;
                 latestLoanAmount = record.Loan;
             }
         }
     });

      let hasUnclearedLoan = false;
      if (lastLoanDate) {
          const paymentExistsAfterLoan = userData.some(r =>
              r.Payment > 0 &&
              r.Date instanceof Date && !isNaN(r.Date) && r.Date.getTime() !== 0 &&
              r.Date > lastLoanDate
          );
          hasUnclearedLoan = !paymentExistsAfterLoan;
      }

     if (!hasUnclearedLoan) { latestLoanAmount = 0; }

     const overallBalance = (totalSIP + totalPayment) - totalLoan;
     const netLoanOutstanding = Math.max(0, totalLoan - totalPayment);
     const sipStatusInfo = getSipStatus(userData);
     const isPrime = primeMembers.some(pm => pm.toLowerCase() === canonicalName.toLowerCase());

     return {
         name: canonicalName,
         totalSIP: totalSIP,
         totalLoan: totalLoan,
         totalPayment: totalPayment,
         overallBalance: overallBalance,
         netLoanOutstanding: netLoanOutstanding,
         imageUrl: latestImageUrl || defaultProfilePic,
         joinDate: formatDate(joinDate),
         sipStatusText: sipStatusInfo.statusText,
         sipStatusClass: sipStatusInfo.statusClass,
         hasUnclearedLoan: hasUnclearedLoan,
         latestUnclearedLoanAmount: hasUnclearedLoan ? latestLoanAmount : 0,
         isPrimeMember: isPrime
     };
}


function showSuggestions(text) {
    // Suggestions logic remains similar
    suggestionsBox.innerHTML = '';
    const lowInput = text.toLowerCase().trim();

    if (lowInput.length < 2) {
        suggestionsBox.style.display = 'none';
        return;
    }

    const matches = new Set();
    const nameCheck = lowInput.split(' ')[0];

    // Suggest members (if data loaded)
    if (cachedSheetData) {
        const memberNames = [...new Set(cachedSheetData.map(r => r.Name))];
        memberNames.forEach(name => {
            if (name.toLowerCase().includes(lowInput) || name.toLowerCase().startsWith(nameCheck)) {
                matches.add(`${name} ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£`);
            }
        });
    } else { // Suggest prime members if data not loaded
        primeMembers.forEach(name => {
            if (name.toLowerCase().includes(lowInput) || name.toLowerCase().startsWith(nameCheck)) {
                matches.add(`${name} ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£`);
            }
        });
    }

    // Suggest rules/FAQs
    dataSegments.forEach(seg => {
        if (seg.question.toLowerCase().includes(lowInput)) {
            matches.add(seg.question);
        }
    });

    // Suggest common actions based on keywords
     if ("member".includes(lowInput) || "list".includes(lowInput) || "‡§∏‡§≠‡•Ä".includes(lowInput)) {
         matches.add("‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì");
         matches.add("‡§ï‡•Å‡§≤ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§ø‡§§‡§®‡•á ‡§π‡•à‡§Ç?");
     }
     if ("eligible".includes(lowInput) || "loan".includes(lowInput) || "‡§≤‡•ã‡§®".includes(lowInput) || "‡§™‡§æ‡§§‡•ç‡§∞".includes(lowInput)) {
          matches.add("‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç ‡§≤‡•ã‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§§‡•ç‡§∞ ‡§π‡•Ç‡§Å?");
          matches.add("Maximum loan kitna le sakte hain?");
          matches.add("Loan lene ke liye requirements kya hain?");
     }
      if ("balance".includes(lowInput) || "‡§¨‡•à‡§≤‡•á‡§Ç‡§∏".includes(lowInput) ) {
          matches.add("‡§Æ‡•á‡§∞‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§ï‡§ø‡§§‡§®‡§æ ‡§π‡•à?");
          if(cachedSheetData){ // Suggest specific members if data loaded
              const memberNames = [...new Set(cachedSheetData.map(r => r.Name))].slice(0, 2);
              memberNames.forEach(name => matches.add(`${name} ‡§ï‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§¶‡§ø‡§ñ‡§æ‡§ì`));
          }
      }
      if ("sip".includes(lowInput) || "‡§ï‡§ø‡§∂‡•ç‡§§".includes(lowInput) ) {
          matches.add("Monthly SIP amount aur deadline kya hai?");
          matches.add("SIP bounce hone par kya hota hai?");
      }


    if (matches.size === 0) {
        suggestionsBox.style.display = 'none';
        return;
    }

    // Display suggestions
    Array.from(matches).slice(0, 6).forEach(q_text => {
        const div = document.createElement('div');
        div.className = 'suggestion';
        div.textContent = q_text;
        const sanitizedQText = q_text.replace(/'/g, "\\'").replace(/"/g, '\\"');
        div.onclick = () => {
            inputBox.value = q_text;
            suggestionsBox.style.display = 'none';
            send();
        };
        suggestionsBox.appendChild(div);
    });
    suggestionsBox.style.display = 'flex';
}


// --- *** Enhanced Smart Send Function *** ---
async function send() {
    const query = inputBox.value.trim();
    if (!query) return;

    appendMessage(query, "user");
    inputBox.value = '';
    suggestionsBox.style.display = 'none';
    const typingIndicator = appendMessage("‡§∏‡§Æ‡§ù ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å...", "bot typing"); // Updated typing text

    // Basic checks for API Key and Sheet URL
    if (!API_KEY || API_KEY === "YOUR_GEMINI_API_KEY" || API_KEY.length < 30) {
        typingIndicator?.remove();
        appendMessage("‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: Gemini API ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§", "bot"); return;
    }
    if (!SHEET_API_URL || SHEET_API_URL === "YOUR_GOOGLE_SHEET_APPS_SCRIPT_URL" || !SHEET_API_URL.startsWith("https://script.google.com/")) {
       typingIndicator?.remove();
       appendMessage("‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: Google Sheet URL ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§", "bot"); return;
    }

    // --- Step 1: Prepare context for API ---
    let memberNamesList = [];
    let sheetDataReady = cachedSheetData !== null;
    if (!sheetDataReady) {
        sheetDataReady = await fetchAndProcessSheetData(); // Fetch if not already cached
    }
    if (sheetDataReady) {
        memberNamesList = [...new Set(cachedSheetData.map(r => r.Name))];
    } else {
        // If sheet data failed to load, inform intents that need it later
        console.warn("Sheet data is not available.");
    }

    // Prepare rules context as a numbered list for potentially easier parsing by LLM
    const rulesContext = dataSegments.map((seg, index) => `${index + 1}. ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: ${seg.question}\n   ‡§â‡§§‡•ç‡§§‡§∞: ${seg.answer}`).join('\n\n');
    const knownNamesString = memberNamesList.length > 0 ? memberNamesList.join(', ') : "‡§ï‡•ã‡§à ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü";

    // --- Step 2: Define Intents and Refined Prompt ---
    const possibleIntents = [
        "get_rule",             // Ask about a rule/FAQ
        "get_member_details",   // Ask for full member details
        "check_balance",        // Ask for member balance
        "check_loan_eligibility",// Ask about member loan eligibility
        "list_all_members",     // Ask for member list
        "get_member_count",     // Ask for total members
        "greet",                // Simple greeting
        "thank_you",            // Simple thanks
        "general_query"         // Anything else / fallback
    ];

    // Refined prompt asking for JSON output and confidence score
    const prompt = `
‡§Ü‡§™ '‡§¨‡•à‡§Ç‡§ï ‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§ö‡•à‡§ü‡§¨‡•â‡§ü' ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Ø‡§æ ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡•Ä ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§®‡§æ ‡§î‡§∞ ‡§∏‡§Ç‡§∞‡§ö‡§ø‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§®‡§æ ‡§π‡•à‡•§

‡§®‡§ø‡§Ø‡§Æ/FAQ ‡§°‡•á‡§ü‡§æ:
--- RULES START ---
${rulesContext}
--- RULES END ---

‡§ú‡•ç‡§û‡§æ‡§§ ‡§∏‡§¶‡§∏‡•ç‡§Ø: ${knownNamesString}

‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: "${query}"

‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§æ‡§∞‡•ç‡§Ø:
1. ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ï‡§æ ‡§á‡§∞‡§æ‡§¶‡§æ (intent) ‡§™‡§π‡§ö‡§æ‡§®‡•á‡§Ç‡•§ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§á‡§∞‡§æ‡§¶‡•á ‡§π‡•à‡§Ç: ${possibleIntents.join(', ')}.
2. ‡§Ø‡§¶‡§ø ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§π‡•à, ‡§§‡•ã ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§æ ‡§®‡§æ‡§Æ (member_name) ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•Ç‡§ö‡•Ä ‡§Æ‡•á‡§Ç ‡§®‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§Ö‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§π‡•à, ‡§§‡•ã ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•Ç‡§ö‡•Ä (${knownNamesString}) ‡§∏‡•á ‡§∏‡§¨‡§∏‡•á ‡§Æ‡§ø‡§≤‡§§‡•á-‡§ú‡•Å‡§≤‡§§‡•á ‡§®‡§æ‡§Æ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§≤‡§ó‡§æ‡§è‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§§‡•ã null ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡•ç‡§µ‡§Ø‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ ‡§∞‡§π‡§æ ‡§π‡•à (‡§ú‡•à‡§∏‡•á '‡§Æ‡•á‡§∞‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏'), ‡§§‡•ã member_name ‡§ï‡•ã "self" ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§
3. ‡§Ø‡§¶‡§ø ‡§á‡§∞‡§æ‡§¶‡§æ 'get_rule' ‡§π‡•à, ‡§§‡•ã ‡§ä‡§™‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è RULES ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§∞‡§æ‡§∏‡§Ç‡§ó‡§ø‡§ï ‡§®‡§ø‡§Ø‡§Æ ‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ (answer) ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§®‡§ø‡§Ø‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à, ‡§§‡•ã null ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§
4. ‡§Ü‡§™‡§ï‡•á ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø‡§§‡§æ (confidence) ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§≤‡§ó‡§æ‡§è‡§Ç: 'high', 'medium', ‡§Ø‡§æ 'low'‡•§
5. ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï JSON ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§≤‡•å‡§ü‡§æ‡§è‡§Ç:
   {
     "intent": "[‡§™‡§π‡§ö‡§æ‡§®‡§æ ‡§ó‡§Ø‡§æ ‡§á‡§∞‡§æ‡§¶‡§æ]",
     "member_name": "[‡§®‡§ø‡§ï‡§æ‡§≤‡§æ ‡§ó‡§Ø‡§æ ‡§®‡§æ‡§Æ / 'self' / null]",
     "answer": "[‡§®‡§ø‡§Ø‡§Æ ‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§Ø‡§¶‡§ø intent='get_rule', ‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ null]",
     "confidence": "[high/medium/low]"
   }

‡§â‡§¶‡§æ‡§π‡§∞‡§£:
- ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: "Mithlesh Sahni ‡§ï‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏?" -> {"intent": "check_balance", "member_name": "Mithlesh Sahni", "answer": null, "confidence": "high"}
- ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: "‡§≤‡•ã‡§® ‡§™‡§∞ ‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä ‡§®‡§ø‡§Ø‡§Æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à‡§Ç?" -> {"intent": "get_rule", "member_name": null, "answer": "‡§Ø‡§¶‡§ø ‡§≤‡•ã‡§® 31 ‡§¶‡§ø‡§® ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§∞‡§π‡§§‡§æ ‡§π‡•à, ‡§§‡•ã...5% ‡§™‡•á‡§®‡§≤‡•ç‡§ü‡•Ä (RED MEMBER) ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‡•§", "confidence": "high"}
- ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á" -> {"intent": "greet", "member_name": null, "answer": null, "confidence": "high"}
- ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: "‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡•à‡§Ç ‡§≤‡•ã‡§® ‡§≤‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å?" -> {"intent": "check_loan_eligibility", "member_name": "self", "answer": null, "confidence": "medium"}
- ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: "‡§ö‡§æ‡§Å‡§¶ ‡§™‡§∞ ‡§ï‡•å‡§® ‡§ó‡§Ø‡§æ?" -> {"intent": "general_query", "member_name": null, "answer": null, "confidence": "high"}

‡§ï‡•á‡§µ‡§≤ JSON ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡•á‡§Ç:
`;

    // --- Step 3: Call Gemini API ---
    const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
    let analysisResult = null;

    try {
        console.log("Sending query to Gemini for analysis (enhanced)...");
        const response = await fetch(GEMINI_API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                contents: [{ parts: [{ text: prompt }] }],
                generationConfig: {
                    temperature: 0.1, // Very low temperature for structured JSON
                    maxOutputTokens: 400,
                    responseMimeType: "application/json",
                },
                safetySettings: [ // Standard safety settings
                    { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, { category: "HARM_CATEGORY_HATE_SPEECH", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, { category: "HARM_CATEGORY_SEXUALLY_EXPLICIT", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_MEDIUM_AND_ABOVE" },
                ]
            }),
        });

        typingIndicator?.remove();

        if (!response.ok) {
            const errorBody = await response.text(); console.error("Gemini API Error Response:", errorBody);
            throw new Error(`API Error ${response.status}: ${response.statusText}`);
        }
        const js = await response.json();

        if (!js.candidates?.[0]?.content?.parts?.[0]?.text) {
            if (js.promptFeedback?.blockReason) { throw new Error(`Content Blocked (${js.promptFeedback.blockReason})`); }
            console.error("Unexpected API response structure:", js);
            throw new Error("API ‡§∏‡•á ‡§ï‡•ã‡§à ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§");
        }

        const rawJsonText = js.candidates[0].content.parts[0].text;
        console.log("Raw JSON from Gemini:", rawJsonText); // Log for debugging
        try {
            const cleanedJsonText = rawJsonText.replace(/^```json\s*/, '').replace(/\s*```$/, ''); // Clean markdown markers
            analysisResult = JSON.parse(cleanedJsonText);
            console.log("Parsed Analysis Result:", analysisResult);

            // Validate essential fields
            if (!analysisResult.intent || !possibleIntents.includes(analysisResult.intent)) {
                 console.warn("Invalid or missing intent in response:", analysisResult.intent);
                 analysisResult.intent = "general_query"; // Fallback if intent is bad
                 analysisResult.confidence = "low";
            }
             if (!analysisResult.confidence) {
                 analysisResult.confidence = "medium"; // Assume medium if missing
             }

        } catch (parseError) {
            console.error("Failed to parse JSON response from Gemini:", parseError, "\nRaw Text:", rawJsonText);
            // Fallback: treat as general query, use the raw text as potential answer if it's not JSON-like
             const seemsLikeJson = rawJsonText.trim().startsWith('{') && rawJsonText.trim().endsWith('}');
            analysisResult = {
                intent: "general_query", member_name: null,
                answer: seemsLikeJson ? null : rawJsonText, // Use raw text only if it's not JSON
                confidence: "low"
            };
        }

    } catch (error) {
        typingIndicator?.remove();
        console.error("Gemini Processing Error:", error);
        appendMessage(`‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§Ü‡§™‡§ï‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§ (${error.message})`, "bot");
        displayFallbackSuggestions(); return;
    }

    // --- Step 4: Handle Based on Intent and Confidence ---
    if (!analysisResult || !analysisResult.intent) {
         console.error("Analysis result or intent is missing after processing:", analysisResult);
         appendMessage("‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã ‡§†‡•Ä‡§ï ‡§∏‡•á ‡§∏‡§Æ‡§ù ‡§®‡§π‡•Ä‡§Ç ‡§™‡§æ‡§Ø‡§æ‡•§", "bot");
         displayFallbackSuggestions(); return;
    }

    const intent = analysisResult.intent;
    let memberName = analysisResult.member_name; // Can be name, "self", or null
    const confidence = analysisResult.confidence;
    const ruleAnswer = analysisResult.answer;

     // If confidence is low, perhaps ask for clarification before proceeding with complex actions
     if (confidence === 'low' && intent !== 'general_query' && intent !== 'greet' && intent !== 'thank_you') {
         console.warn(`Low confidence ('${confidence}') for intent '${intent}'. Asking for clarification.`);
         appendMessage("‡§Æ‡•à‡§Ç ‡§™‡•Ç‡§∞‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á ‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Ç‡§Å ‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§™‡•Ç‡§õ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§•‡•ã‡§°‡§º‡§æ ‡§î‡§∞ ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç?", "bot");
         displayFallbackSuggestions();
         return; // Stop processing this query
     }

    // --- Step 5: Execute Action Based on Intent ---
    try {
         // Re-check sheet data readiness if needed for specific intents
         const needsSheetDataCheck = ["get_member_details", "check_balance", "check_loan_eligibility", "list_all_members", "get_member_count"].includes(intent);
         if (needsSheetDataCheck && !sheetDataReady) {
              appendMessage("‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ ‡§Ö‡§≠‡•Ä ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§ï‡•ç‡§∑‡§£ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§", "bot");
              // Optionally trigger fetch again: fetchAndProcessSheetData();
              return;
         }

        switch (intent) {
            case "greet":
                appendMessage("‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å?", "bot");
                displayFallbackSuggestions("‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?");
                break;
            case "thank_you":
                appendMessage("‡§ï‡•ã‡§à ‡§¨‡§æ‡§§ ‡§®‡§π‡•Ä‡§Ç! ‡§Ö‡§ó‡§∞ ‡§Ü‡§™‡§ï‡•ã ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§ö‡§æ‡§π‡§ø‡§è ‡§§‡•ã ‡§Æ‡•Å‡§ù‡•á ‡§¨‡§§‡§æ‡§è‡§Ç‡•§", "bot");
                break;

            case "get_rule":
                if (ruleAnswer) {
                    const messageElement = appendMessage("", "bot");
                    typeEffect(ruleAnswer, messageElement, () => displayFallbackSuggestions("‡§Ö‡§®‡•ç‡§Ø ‡§®‡§ø‡§Ø‡§Æ ‡§Ø‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç:"));
                } else {
                     appendMessage(`‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§Æ‡•Å‡§ù‡•á ‡§Ü‡§™‡§ï‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§® "${query}" ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡•ã‡§à ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§®‡§ø‡§Ø‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§`, "bot");
                     displayFallbackSuggestions();
                }
                break;

            case "get_member_details":
            case "check_balance":
            case "check_loan_eligibility":
                 if (!memberName || memberName === "self") {
                     // Needs name, but API indicated 'self' or couldn't find one clearly
                     appendMessage("‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¨‡§§‡§æ‡§è‡§Ç ‡§ú‡§ø‡§∏‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ü‡§™ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§ (‡§â‡§¶‡§æ‡§π‡§∞‡§£: '‡§Ö‡§Æ‡§ø‡§§ ‡§ï‡•Å‡§Æ‡§æ‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£')", "bot");
                     const memberNamesSuggest = memberNamesList.length > 0 ? memberNamesList : primeMembers;
                      appendSuggestionGroup("‡§Ü‡§™ ‡§á‡§®‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:", memberNamesSuggest.slice(0,5));
                 } else {
                    // Proceed with the extracted member name
                    const userData = getUserDataAggregated(memberName);
                    if (userData) {
                        if (intent === "get_member_details") {
                             // Display full card (Enhanced HTML structure)
                             const primeTagHtml = userData.isPrimeMember ? `<span class='prime-tag-on-photo'>‚≠ê Prime</span>` : '';
                             const unclearedLoanHtml = userData.hasUnclearedLoan ? `<p><span class="label"><span class="icon">‚ö†Ô∏è</span>‡§π‡§æ‡§≤‡§ø‡§Ø‡§æ ‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§≤‡•ã‡§®:</span> <span class='value loan-highlight'>‚Çπ${userData.latestUnclearedLoanAmount.toLocaleString('en-IN')}</span></p>` : '';
                             let htmlResponse = `
                                 <div class='user-details-card'>
                                     <div class="user-details-header">
                                         <div class="profile-pic-container">
                                             <img src="${userData.imageUrl}" alt="${userData.name}" class="profile-pic" onclick="openImageModal('${userData.imageUrl}')">
                                             ${primeTagHtml}
                                         </div>
                                         <div class="user-info">
                                             <h3>${userData.name}</h3>
                                             <p><span class="label">üóìÔ∏è ‡§ú‡•ç‡§µ‡§æ‡§á‡§® ‡§§‡§ø‡§•‡§ø:</span> ${userData.joinDate}</p>
                                         </div>
                                     </div>
                                     <div class="user-stats">
                                         <p><span class="label"><span class="icon">üí∞</span>‡§ï‡•Å‡§≤ SIP ‡§ú‡§Æ‡§æ:</span> <span class="value">‚Çπ${userData.totalSIP.toLocaleString('en-IN')}</span></p>
                                         <p><span class="label"><span class="icon">üí∏</span>‡§ï‡•Å‡§≤ ‡§≤‡•ã‡§® ‡§≤‡§ø‡§Ø‡§æ:</span> <span class="value">‚Çπ${userData.totalLoan.toLocaleString('en-IN')}</span></p>
                                         <p><span class="label"><span class="icon">‚úÖ</span>‡§ï‡•Å‡§≤ ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®:</span> <span class="value">‚Çπ${userData.totalPayment.toLocaleString('en-IN')}</span></p>
                                         <p><span class="label"><span class="icon">üè¶</span>‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏:</span> <strong class="value">‚Çπ${userData.overallBalance.toLocaleString('en-IN')}</strong></p>
                                         <p><span class="label"><span class="icon">üìâ</span>‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§≤‡•ã‡§® ‡§∞‡§æ‡§∂‡§ø:</span> <span class="value ${userData.netLoanOutstanding > 0 ? 'loan-highlight' : ''}">‚Çπ${userData.netLoanOutstanding.toLocaleString('en-IN')}</span></p>
                                         ${unclearedLoanHtml}
                                         <p><span class="label"><span class="icon">üîî</span>‡§Æ‡§æ‡§∏‡§ø‡§ï SIP ‡§∏‡•ç‡§•‡§ø‡§§‡§ø:</span> <span class="value"><span class="sip-status ${userData.sipStatusClass}">${userData.sipStatusText}</span></span></p>
                                     </div>
                                 </div>`;
                             appendMessage(htmlResponse, "bot", true);
                             displayFallbackSuggestions(`‡§î‡§∞ ‡§ï‡•Å‡§õ ${userData.name} ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç?`);
                        } else if (intent === "check_balance") {
                            appendMessage(`${userData.name} ‡§ï‡§æ ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‚Çπ${userData.overallBalance.toLocaleString('en-IN')} ‡§π‡•à‡•§`, 'bot');
                             appendSuggestionGroup("‡§î‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?", [`${userData.name} ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç`, `${userData.name} ‡§ï‡•Ä ‡§™‡§æ‡§§‡•ç‡§∞‡§§‡§æ ‡§¶‡•á‡§ñ‡•á‡§Ç`, "‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§ì"]);
                        } else { // check_loan_eligibility
                             const eligibilityResult = calculateEligibility(userData.name, userData.overallBalance, communityBalance);
                             let eligibilityResponse = eligibilityResult.isEligible
                                ? `‚úÖ ‡§π‡§æ‡§Å, ${userData.name} ‡§≤‡•ã‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§§‡•ç‡§∞ ‡§π‡•à‡§Ç‡•§ ‡§µ‡•á ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‚Çπ${eligibilityResult.approvedAmount.toLocaleString('en-IN')} ‡§§‡§ï ‡§ï‡§æ ‡§≤‡•ã‡§® ‡§≤‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§`
                                : `‚ùå ‡§®‡§π‡•Ä‡§Ç, ${userData.name} ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§≤‡•ã‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§§‡•ç‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§ ${eligibilityResult.reason || ''}`;
                             appendMessage(eligibilityResponse, "bot");
                             appendSuggestionGroup("‡§î‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?", [`${userData.name} ‡§ï‡§æ ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç`, `${userData.name} ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç`, "Loan lene ke liye requirements kya hain?"]);
                        }
                    } else {
                        appendMessage(`‡§Æ‡§æ‡§´‡§º ‡§ï‡•Ä‡§ú‡§ø‡§è, "${memberName}" ‡§®‡§æ‡§Æ ‡§ï‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§®‡§æ‡§Æ ‡§ï‡•Ä ‡§∏‡•ç‡§™‡•á‡§≤‡§ø‡§Ç‡§ó ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç‡•§`, "bot");
                         appendSuggestionGroup("‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§á‡§®‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ ‡§∞‡§π‡•á ‡§•‡•á?", memberNamesList.slice(0,5));
                    }
                }
                break;

            case "list_all_members":
                 const uniqueNamesList = memberNamesList.sort((a, b) => a.localeCompare(b));
                 if (uniqueNamesList.length > 0) {
                     let html = `<p><strong>‡§∏‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø (${uniqueNamesList.length}):</strong></p><div class='member-list-container'>`;
                     uniqueNamesList.forEach(name => {
                         const sanitizedName = name.replace(/'/g, "\\'").replace(/"/g, '\\"');
                         html += `<div class='clickable-member' onclick="inputBox.value='${sanitizedName} ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£'; send();">${name}</div>`;
                     });
                     html += "</div>";
                     appendMessage(html, 'bot', true);
                 } else { appendMessage("‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§", "bot"); }
                break;

            case "get_member_count":
                 const uniqueNamesCount = memberNamesList.length;
                 appendMessage(`‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§≤ ${uniqueNamesCount} ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡•à‡§Ç‡•§`, "bot");
                 break;

            case "general_query":
            default: // Fallback for unknown intents or general queries
                console.log("Handling as general query with Gemini:", query);
                 // If analysis provided a direct answer (e.g., from failed JSON parse but valid text)
                 if (ruleAnswer) {
                    const messageElement = appendMessage("", "bot");
                    typeEffect(ruleAnswer, messageElement, () => displayFallbackSuggestions("‡§Ö‡§®‡•ç‡§Ø ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç:"));
                    break; // Exit switch here
                 }

                // Otherwise, make a simpler call to Gemini for direct answer generation
                 const simplePrompt = `‡§Ü‡§™ ‡§è‡§ï ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§¨‡•à‡§Ç‡§ï ‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§ö‡•à‡§ü‡§¨‡•â‡§ü ‡§π‡•à‡§Ç‡•§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡•á ‡§™‡•Ç‡§õ‡§æ ‡§π‡•à: "${query}". ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§î‡§∞ ‡§∏‡§ü‡•Ä‡§ï ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§¨‡•à‡§Ç‡§ï ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∏‡•á ‡§Ö‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§π‡•à, ‡§§‡•ã ‡§µ‡§ø‡§®‡§Æ‡•ç‡§∞‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¨‡§§‡§æ‡§è‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡•ã‡§ï‡§∏ ‡§¨‡•à‡§Ç‡§ï ‡§ï‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§™‡§∞ ‡§π‡•à‡•§ ‡§â‡§§‡•ç‡§§‡§∞:`;
                try {
                    const fallbackTyping = appendMessage("...", "bot typing");
                    const fallbackResponse = await fetch(GEMINI_API_URL, {
                        method: "POST", headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: simplePrompt }] }],
                            generationConfig: { temperature: 0.7, maxOutputTokens: 500 },
                            safetySettings: [ { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, { category: "HARM_CATEGORY_HATE_SPEECH", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, { category: "HARM_CATEGORY_SEXUALLY_EXPLICIT", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_MEDIUM_AND_ABOVE" }, ]
                        }),
                    });
                    fallbackTyping?.remove();
                    if (!fallbackResponse.ok) throw new Error(`Fallback API Error ${fallbackResponse.status}`);
                    const fallbackJs = await fallbackResponse.json();
                    if (!fallbackJs.candidates?.[0]?.content?.parts?.[0]?.text) { throw new Error(fallbackJs.promptFeedback?.blockReason ? `Content Blocked (${fallbackJs.promptFeedback.blockReason})` : "Fallback API ‡§∏‡•á ‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä"); }

                    const rawAnswer = fallbackJs.candidates[0].content.parts[0].text.trim();
                    const messageElement = appendMessage("", "bot");
                    typeEffect(rawAnswer, messageElement, () => displayFallbackSuggestions("‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç:"));
                } catch (fallbackError) {
                     fallbackTyping?.remove();
                     console.error("Gemini Fallback Error:", fallbackError);
                     appendMessage(`‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§ ${fallbackError.message || ''}`, "bot");
                     displayFallbackSuggestions();
                }
                break;
        } // End Switch

    } catch (error) {
        console.error("Error handling intent:", intent, error);
        appendMessage("‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§Ü‡§™‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§Ö‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§æ‡§∂‡§ø‡§§ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§", "bot");
        displayFallbackSuggestions();
    }
}


// --- Event Listeners & Initialization ---
// (Event listeners remain the same)
document.addEventListener('click', function(event) {
    if (inputBox && suggestionsBox && !inputBox.contains(event.target) && !suggestionsBox.contains(event.target)) {
        suggestionsBox.style.display = 'none';
    }
});
if (imageModal) {
    imageModal.addEventListener('click', function(event) {
         if (event.target === imageModal) { closeImageModal(); }
    });
}

function handleKey(event) {
    if (event.key === 'Enter') { send(); }
}

// Optional: Fetch data on page load for faster initial response for member queries
document.addEventListener('DOMContentLoaded', () => {
     fetchAndProcessSheetData();
});

</script>

</body>
</html>
